

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>pyequib.main package &mdash; pyEQUIB 0.4.2 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="References" href="../user/reference.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> pyEQUIB
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user/readme.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/reference.html">References</a></li>
</ul>
<p class="caption"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">pyequib.main package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-pyequib">pyequib main module</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pyEQUIB</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>pyequib.main package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api/pyequib.main.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="pyequib-main-package">
<h1>pyequib.main package<a class="headerlink" href="#pyequib-main-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-pyequib">
<span id="pyequib-main-module"></span><h2>pyequib main module<a class="headerlink" href="#module-pyequib" title="Permalink to this headline">¶</a></h2>
<p>This module contains functions for Plasma Diagnostics and Abundance Analysis</p>
<dl class="py function">
<dt id="pyequib.calc_abund_c_ii_rl">
<code class="sig-prename descclassname">pyequib.</code><code class="sig-name descname">calc_abund_c_ii_rl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">temperature</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">density</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wavelength</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">line_flux</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">c_ii_rc_data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h_i_aeff_data</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyequib.html#calc_abund_c_ii_rl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyequib.calc_abund_c_ii_rl" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This function determines the ionic abundance from the observed
flux intensity for the given wavelength of C II recombination line
by using the recombination coefficients from
from Davey et al. (2000) 2000A&amp;AS..142…85D.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>type=double. This function returns the ionic abundanc.</p>
</dd>
<dt class="field-even">Keywords</dt>
<dd class="field-even"><dl class="simple">
<dt>temperature<span class="classifier">in, required, type=float</span></dt><dd><p>electron temperature</p>
</dd>
<dt>density<span class="classifier">in, required, type=float</span></dt><dd><p>electron density</p>
</dd>
<dt>wavelength<span class="classifier">in, required, type=float</span></dt><dd><p>Line Wavelength in Angstrom</p>
</dd>
<dt>line_flux<span class="classifier">in, required, type=float</span></dt><dd><p>line flux intensity</p>
</dd>
<dt>c_ii_rc_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>C II recombination coefficients</p>
</dd>
<dt>h_i_aeff_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>H I recombination coefficients</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Examples</dt>
<dd class="field-odd"><p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyequib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomneb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="s1">&#39;../externals/atomneb/&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_rc_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;atomic-data-rc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_rc_all_file</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_rc_dir</span><span class="p">,</span> <span class="s1">&#39;rc_collection.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_rc_sh95_file</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_rc_dir</span><span class="p">,</span> <span class="s1">&#39;rc_SH95.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;h&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ion</span><span class="o">=</span><span class="s1">&#39;ii&#39;</span> <span class="c1"># H I</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h_i_rc_data</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_aeff_sh95</span><span class="p">(</span><span class="n">atom_rc_sh95_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h_i_aeff_data</span><span class="o">=</span><span class="n">h_i_rc_data</span><span class="p">[</span><span class="s1">&#39;aeff&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;c&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ion</span><span class="o">=</span><span class="s1">&#39;iii&#39;</span> <span class="c1"># C II</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c_ii_rc_data</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_aeff_collection</span><span class="p">(</span><span class="n">atom_rc_all_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">temperature</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">10000.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">density</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">5000.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c_ii_6151_flux</span> <span class="o">=</span> <span class="mf">0.028</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelength</span><span class="o">=</span><span class="mf">6151.43</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abund_c_ii</span><span class="o">=</span><span class="n">pyequib</span><span class="o">.</span><span class="n">calc_abund_c_ii_rl</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="n">density</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">wavelength</span><span class="o">=</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">line_flux</span><span class="o">=</span><span class="n">c_ii_6151_flux</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">c_ii_rc_data</span><span class="o">=</span><span class="n">c_ii_rc_data</span><span class="p">,</span> <span class="n">h_i_aeff_data</span><span class="o">=</span><span class="n">h_i_aeff_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;N(C^2+)/N(H+):&#39;</span><span class="p">,</span> <span class="n">abund_c_ii</span><span class="p">)</span>
<span class="go">   N(C^2+)/N(H+):    0.00063404650</span>
</pre></div>
</div>
</dd>
<dt class="field-even">Categories</dt>
<dd class="field-even"><p>Abundance Analysis, Recombination Lines</p>
</dd>
<dt class="field-odd">Dirs</dt>
<dd class="field-odd"><dl class="simple">
<dt>./</dt><dd><p>Main routines</p>
</dd>
</dl>
</dd>
<dt class="field-even">Author</dt>
<dd class="field-even"><p>Ashkbiz Danehkar</p>
</dd>
<dt class="field-odd">Copyright</dt>
<dd class="field-odd"><p>This library is released under a GNU General Public License.</p>
</dd>
<dt class="field-even">Version</dt>
<dd class="field-even"><p>0.3.0</p>
</dd>
<dt class="field-odd">History</dt>
<dd class="field-odd"><p>Based on recombination coefficients for C II lines from
Davey et al. 2000A&amp;AS..142…85D.</p>
<p>Adopted from MOCASSIN, Ercolano et al. 2005MNRAS.362.1038E.</p>
<p>02/2003, Yong Zhang, added to MOCASSIN.</p>
<p>10/05/2013, A. Danehkar, Translated to IDL code.</p>
<p>15/04/2017, A. Danehkar, Integration with AtomNeb.</p>
<dl class="simple">
<dt>10/07/2019, A. Danehkar, Made a new function calc_emiss_c_ii_rl()</dt><dd><p>for calculating line emissivities and separated it
from calc_abund_c_ii_rl().</p>
</dd>
</dl>
<p>03/10/2020, A. Danehkar, Transferred from IDL to Python.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyequib.calc_abund_c_iii_rl">
<code class="sig-prename descclassname">pyequib.</code><code class="sig-name descname">calc_abund_c_iii_rl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">temperature</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">density</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wavelength</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">line_flux</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">c_iii_rc_data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h_i_aeff_data</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyequib.html#calc_abund_c_iii_rl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyequib.calc_abund_c_iii_rl" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><blockquote>
<div><p>This function determines the ionic abundance from the observed
flux intensity for the given wavelength of C III recombination line
by using the recombination coefficients from
Pequignot et al. 1991A&amp;A…251..680P.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>type=double. This function returns the ionic abundanc.</p>
</dd>
<dt class="field-even">Keywords</dt>
<dd class="field-even"><dl class="simple">
<dt>temperature<span class="classifier">in, required, type=float</span></dt><dd><p>electron temperature</p>
</dd>
<dt>density<span class="classifier">in, required, type=float</span></dt><dd><p>electron density</p>
</dd>
<dt>wavelength<span class="classifier">in, required, type=float</span></dt><dd><p>Line Wavelength in Angstrom</p>
</dd>
<dt>line_flux<span class="classifier">in, required, type=float</span></dt><dd><p>line flux intensity</p>
</dd>
<dt>c_iii_rc_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>C III recombination coefficients</p>
</dd>
<dt>h_i_aeff_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>H I recombination coefficients</p>
</dd>
</dl>
</dd>
</dl>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Examples</dt>
<dd class="field-odd"><blockquote>
<div><p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyequib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomneb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="s1">&#39;../externals/atomneb/&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_rc_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;atomic-data-rc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_rc_ppb91_file</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_rc_dir</span><span class="p">,</span> <span class="s1">&#39;rc_PPB91.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_rc_sh95_file</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_rc_dir</span><span class="p">,</span> <span class="s1">&#39;rc_SH95.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;h&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ion</span><span class="o">=</span><span class="s1">&#39;ii&#39;</span> <span class="c1"># H I</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h_i_rc_data</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_aeff_sh95</span><span class="p">(</span><span class="n">atom_rc_sh95_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h_i_aeff_data</span><span class="o">=</span><span class="n">h_i_rc_data</span><span class="p">[</span><span class="s1">&#39;aeff&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;c&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ion</span><span class="o">=</span><span class="s1">&#39;iv&#39;</span> <span class="c1"># C III</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c_iii_rc_data</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_aeff_ppb91</span><span class="p">(</span><span class="n">atom_rc_ppb91_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">temperature</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">10000.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">density</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">5000.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c_iii_4647_flux</span> <span class="o">=</span> <span class="mf">0.107</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelength</span><span class="o">=</span><span class="mf">4647.42</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abund_c_iii</span><span class="o">=</span><span class="n">pyequib</span><span class="o">.</span><span class="n">calc_abund_c_iii_rl</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="n">density</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                <span class="n">wavelength</span><span class="o">=</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">line_flux</span><span class="o">=</span><span class="n">c_iii_4647_flux</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                <span class="n">c_iii_rc_data</span><span class="o">=</span><span class="n">c_iii_rc_data</span><span class="p">,</span> <span class="n">h_i_aeff_data</span><span class="o">=</span><span class="n">h_i_aeff_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;N(C^3+)/N(H+):&#39;</span><span class="p">,</span> <span class="n">abund_c_iii</span><span class="p">)</span>
<span class="go">   N(C^3+)/N(H+):    0.00017502840</span>
</pre></div>
</div>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Categories</dt>
<dd class="field-odd"><p>Abundance Analysis, Recombination Lines</p>
</dd>
<dt class="field-even">Dirs</dt>
<dd class="field-even"><dl class="simple">
<dt>./</dt><dd><p>Main routines</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Author</dt>
<dd class="field-odd"><p>Ashkbiz Danehkar</p>
</dd>
<dt class="field-even">Copyright</dt>
<dd class="field-even"><p>This library is released under a GNU General Public License.</p>
</dd>
<dt class="field-odd">Version</dt>
<dd class="field-odd"><p>0.3.0</p>
</dd>
<dt class="field-even">History</dt>
<dd class="field-even"><p>Based on effective radiative recombination coefficients for C III lines from
Pequignot, Petitjean, Boisson, C. 1991A&amp;A…251..680P.</p>
<p>18/05/2013, A. Danehkar, Translated to IDL code.</p>
<p>06/04/2017, A. Danehkar, Integration with AtomNeb.</p>
<dl class="simple">
<dt>10/07/2019, A. Danehkar, Made a new function calc_emiss_c_iii_rl()</dt><dd><p>for calculating line emissivities and separated it
from calc_abund_c_iii_rl().</p>
</dd>
</dl>
<p>03/10/2020, A. Danehkar, Transferred from IDL to Python.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyequib.calc_abund_he_i_rl">
<code class="sig-prename descclassname">pyequib.</code><code class="sig-name descname">calc_abund_he_i_rl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">temperature</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">density</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">linenum</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">line_flux</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">he_i_aeff_data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h_i_aeff_data</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyequib.html#calc_abund_he_i_rl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyequib.calc_abund_he_i_rl" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><blockquote>
<div><p>This function determines the ionic abundance from the observed
flux intensity for the given wavelength of He I recombination line
by using the recombination coefficients from Porter et al.
2012MNRAS.425L..28P.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>type=double. This function returns the ionic abundanc.</p>
</dd>
<dt class="field-even">Keywords</dt>
<dd class="field-even"><dl>
<dt>temperature<span class="classifier">in, required, type=float</span></dt><dd><p>electron temperature</p>
</dd>
<dt>density<span class="classifier">in, required, type=float</span></dt><dd><p>electron density</p>
</dd>
<dt>linenum<span class="classifier">in, required, type=int</span></dt><dd><p>Line Number for Wavelength</p>
<p>Wavelength=4120.84:linenum=7,</p>
<p>Wavelength=4387.93: linenum=8,</p>
<p>Wavelength=4437.55: linenum=9,</p>
<p>Wavelength=4471.50: linenum=10,</p>
<p>Wavelength=4921.93: linenum=12,</p>
<p>Wavelength=5015.68: linenum=13,</p>
<p>Wavelength=5047.74: linenum=14,</p>
<p>Wavelength=5875.66: linenum=15,</p>
<p>Wavelength=6678.16: linenum=16,</p>
<p>Wavelength=7065.25: linenum=17,</p>
<p>Wavelength=7281.35: linenum=18.</p>
</dd>
<dt>line_flux<span class="classifier">in, required, type=float</span></dt><dd><p>line flux intensity</p>
</dd>
<dt>he_i_aeff_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>He I recombination coefficients</p>
</dd>
<dt>h_i_aeff_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>H I recombination coefficients</p>
</dd>
</dl>
</dd>
</dl>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Examples</dt>
<dd class="field-odd"><blockquote>
<div><p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyequib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomneb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="s1">&#39;../externals/atomneb/&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_rc_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;atomic-data-rc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_rc_he_i_file</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_rc_dir</span><span class="p">,</span> <span class="s1">&#39;rc_he_ii_PFSD12.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_rc_sh95_file</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_rc_dir</span><span class="p">,</span> <span class="s1">&#39;rc_SH95.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;h&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ion</span><span class="o">=</span><span class="s1">&#39;ii&#39;</span> <span class="c1"># H I</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h_i_rc_data</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_aeff_sh95</span><span class="p">(</span><span class="n">atom_rc_sh95_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h_i_aeff_data</span><span class="o">=</span><span class="n">h_i_rc_data</span><span class="p">[</span><span class="s1">&#39;aeff&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;he&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ion</span><span class="o">=</span><span class="s1">&#39;ii&#39;</span> <span class="c1"># He I</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">he_i_rc_data</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_aeff_he_i_pfsd12</span><span class="p">(</span><span class="n">atom_rc_he_i_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">he_i_aeff_data</span><span class="o">=</span><span class="n">he_i_rc_data</span><span class="p">[</span><span class="s1">&#39;aeff&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">temperature</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">10000.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">density</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">5000.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">he_i_4471_flux</span><span class="o">=</span> <span class="mf">2.104</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">linenum</span><span class="o">=</span><span class="mi">10</span><span class="c1"># 4471.50</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abund_he_i</span><span class="o">=</span><span class="n">pyequib</span><span class="o">.</span><span class="n">calc_abund_he_i_rl</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="n">density</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                 <span class="n">linenum</span><span class="o">=</span><span class="n">linenum</span><span class="p">,</span> <span class="n">line_flux</span><span class="o">=</span><span class="n">he_i_4471_flux</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                 <span class="n">he_i_aeff_data</span><span class="o">=</span><span class="n">he_i_aeff_data</span><span class="p">,</span> <span class="n">h_i_aeff_data</span><span class="o">=</span><span class="n">h_i_aeff_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;N(He^+)/N(H^+):&#39;</span><span class="p">,</span> <span class="n">abund_he_i</span><span class="p">)</span>
<span class="go">   N(He^+)/N(H^+):     0.040848393</span>
</pre></div>
</div>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Categories</dt>
<dd class="field-odd"><p>Abundance Analysis, Recombination Lines</p>
</dd>
<dt class="field-even">Dirs</dt>
<dd class="field-even"><dl class="simple">
<dt>./</dt><dd><p>Main routines</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Author</dt>
<dd class="field-odd"><p>Ashkbiz Danehkar</p>
</dd>
<dt class="field-even">Copyright</dt>
<dd class="field-even"><p>This library is released under a GNU General Public License.</p>
</dd>
<dt class="field-odd">Version</dt>
<dd class="field-odd"><p>0.3.0</p>
</dd>
<dt class="field-even">History</dt>
<dd class="field-even"><p>Based on improved He I emissivities in the case B
from Porter et al. 2012MNRAS.425L..28P</p>
<p>15/12/2013, A. Danehkar, IDL code written.</p>
<p>20/03/2017, A. Danehkar, Integration with AtomNeb.</p>
<dl class="simple">
<dt>10/07/2019, A. Danehkar, Made a new function calc_emiss_he_i_rl()</dt><dd><p>for calculating line emissivities and separated it
from calc_abund_he_i_rl().</p>
</dd>
</dl>
<p>03/10/2020, A. Danehkar, Transferred from IDL to Python.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyequib.calc_abund_he_ii_rl">
<code class="sig-prename descclassname">pyequib.</code><code class="sig-name descname">calc_abund_he_ii_rl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">temperature</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">density</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">line_flux</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">he_ii_aeff_data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h_i_aeff_data</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyequib.html#calc_abund_he_ii_rl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyequib.calc_abund_he_ii_rl" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><blockquote>
<div><p>This function determines the ionic abundance from the observed
flux intensity for the He II recombination line 4686 A
by using the helium emissivities from
Storey &amp; Hummer, 1995MNRAS.272…41S.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>type=double. This function returns the ionic abundanc.</p>
</dd>
<dt class="field-even">Keywords</dt>
<dd class="field-even"><dl class="simple">
<dt>temperature<span class="classifier">in, required, type=float</span></dt><dd><p>electron temperature</p>
</dd>
<dt>density<span class="classifier">in, required, type=float</span></dt><dd><p>electron density</p>
</dd>
<dt>line_flux<span class="classifier">in, required, type=float</span></dt><dd><p>line flux intensity</p>
</dd>
<dt>he_ii_aeff_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>He II recombination coefficients</p>
</dd>
<dt>h_i_aeff_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>H I recombination coefficients</p>
</dd>
</dl>
</dd>
</dl>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Examples</dt>
<dd class="field-odd"><blockquote>
<div><p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyequib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomneb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="s1">&#39;../externals/atomneb/&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_rc_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;atomic-data-rc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_rc_he_i_file</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_rc_dir</span><span class="p">,</span> <span class="s1">&#39;rc_he_ii_PFSD12.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_rc_sh95_file</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_rc_dir</span><span class="p">,</span> <span class="s1">&#39;rc_SH95.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;h&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ion</span><span class="o">=</span><span class="s1">&#39;ii&#39;</span> <span class="c1"># H I</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h_i_rc_data</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_aeff_sh95</span><span class="p">(</span><span class="n">atom_rc_sh95_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h_i_aeff_data</span><span class="o">=</span><span class="n">h_i_rc_data</span><span class="p">[</span><span class="s1">&#39;aeff&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;he&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ion</span><span class="o">=</span><span class="s1">&#39;iii&#39;</span> <span class="c1"># He II</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">he_ii_rc_data</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_aeff_sh95</span><span class="p">(</span><span class="n">atom_rc_sh95_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">he_ii_aeff_data</span><span class="o">=</span><span class="n">he_ii_rc_data</span><span class="p">[</span><span class="s1">&#39;aeff&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">temperature</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">10000.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">density</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">5000.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">he_ii_4686_flux</span> <span class="o">=</span> <span class="mf">135.833</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abund_he_ii</span><span class="o">=</span><span class="n">pyequib</span><span class="o">.</span><span class="n">calc_abund_he_ii_rl</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="n">density</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                <span class="n">line_flux</span><span class="o">=</span><span class="n">he_ii_4686_flux</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                <span class="n">he_ii_aeff_data</span><span class="o">=</span><span class="n">he_ii_aeff_data</span><span class="p">,</span> <span class="n">h_i_aeff_data</span><span class="o">=</span><span class="n">h_i_aeff_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;N(He^2+)/N(H^+):&#39;</span><span class="p">,</span> <span class="n">abund_he_ii</span><span class="p">)</span>
<span class="go">   N(He^2+)/N(H^+):      0.11228817</span>
</pre></div>
</div>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Categories</dt>
<dd class="field-odd"><p>Abundance Analysis, Recombination Lines</p>
</dd>
<dt class="field-even">Dirs</dt>
<dd class="field-even"><dl class="simple">
<dt>./</dt><dd><p>Main routines</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Author</dt>
<dd class="field-odd"><p>Ashkbiz Danehkar</p>
</dd>
<dt class="field-even">Copyright</dt>
<dd class="field-even"><p>This library is released under a GNU General Public License.</p>
</dd>
<dt class="field-odd">Version</dt>
<dd class="field-odd"><p>0.3.0</p>
</dd>
<dt class="field-even">History</dt>
<dd class="field-even"><p>Based on He II emissivities
from Storey &amp; Hummer, 1995MNRAS.272…41S.</p>
<p>15/12/2013, A. Danehkar, IDL code written.</p>
<p>02/04/2017, A. Danehkar, Integration with AtomNeb.</p>
<dl class="simple">
<dt>10/07/2019, A. Danehkar, Made a new function calc_emiss_he_ii_rl()</dt><dd><p>for calculating line emissivities and separated it
from calc_abund_he_ii_rl().</p>
</dd>
</dl>
<p>03/10/2020, A. Danehkar, Transferred from IDL to Python.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyequib.calc_abund_n_ii_rl">
<code class="sig-prename descclassname">pyequib.</code><code class="sig-name descname">calc_abund_n_ii_rl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">temperature</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">density</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wavelength</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">line_flux</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">n_ii_rc_br</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">n_ii_rc_data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h_i_aeff_data</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyequib.html#calc_abund_n_ii_rl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyequib.calc_abund_n_ii_rl" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This function determines the ionic abundance from the observed
flux intensity for the given wavelength of N II recombination line
by using the recombination coefficients from
Escalante &amp; Victor 1990ApJS…73..513E.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>type=double. This function returns the ionic abundanc.</p>
</dd>
<dt class="field-even">Keywords</dt>
<dd class="field-even"><dl class="simple">
<dt>temperature<span class="classifier">in, required, type=float</span></dt><dd><p>electron temperature</p>
</dd>
<dt>density<span class="classifier">in, required, type=float</span></dt><dd><p>electron density</p>
</dd>
<dt>wavelength<span class="classifier">in, required, type=float</span></dt><dd><p>Line Wavelength in Angstrom</p>
</dd>
<dt>line_flux<span class="classifier">in, required, type=float</span></dt><dd><p>line flux intensity</p>
</dd>
<dt>n_ii_rc_br<span class="classifier">in, required, type=array/object</span></dt><dd><p>N II branching ratios (Br)</p>
</dd>
<dt>n_ii_rc_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>N II recombination coefficients</p>
</dd>
<dt>h_i_aeff_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>H I recombination coefficients</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Examples</dt>
<dd class="field-odd"><p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyequib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomneb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="s1">&#39;../externals/atomneb/&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_rc_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;atomic-data-rc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_rc_all_file</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_rc_dir</span><span class="p">,</span> <span class="s1">&#39;rc_collection.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_rc_sh95_file</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_rc_dir</span><span class="p">,</span> <span class="s1">&#39;rc_SH95.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;h&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ion</span><span class="o">=</span><span class="s1">&#39;ii&#39;</span> <span class="c1"># H I</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h_i_rc_data</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_aeff_sh95</span><span class="p">(</span><span class="n">atom_rc_sh95_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h_i_aeff_data</span><span class="o">=</span><span class="n">h_i_rc_data</span><span class="p">[</span><span class="s1">&#39;aeff&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ion</span><span class="o">=</span><span class="s1">&#39;iii&#39;</span> <span class="c1"># N II</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_ii_rc_data</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_aeff_collection</span><span class="p">(</span><span class="n">atom_rc_all_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_ii_rc_data_br</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_aeff_collection</span><span class="p">(</span><span class="n">atom_rc_all_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">,</span> <span class="n">br</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">temperature</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">10000.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">density</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">5000.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_ii_4442_flux</span> <span class="o">=</span> <span class="mf">0.017</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelength</span><span class="o">=</span><span class="mf">4442.02</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abund_n_ii</span><span class="o">=</span><span class="n">pyequib</span><span class="o">.</span><span class="n">calc_abund_n_ii_rl</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="n">density</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">wavelength</span><span class="o">=</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">line_flux</span><span class="o">=</span><span class="n">n_ii_4442_flux</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">n_ii_rc_br</span><span class="o">=</span><span class="n">n_ii_rc_data_br</span><span class="p">,</span> <span class="n">n_ii_rc_data</span><span class="o">=</span><span class="n">n_ii_rc_data</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">h_i_aeff_data</span><span class="o">=</span><span class="n">h_i_aeff_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;N(N^2+)/N(H+):&#39;</span><span class="p">,</span> <span class="n">abund_n_ii</span><span class="p">)</span>
<span class="go">   N(N^2+)/N(H+):   0.00069297541</span>
</pre></div>
</div>
</dd>
<dt class="field-even">Categories</dt>
<dd class="field-even"><p>Abundance Analysis, Recombination Lines</p>
</dd>
<dt class="field-odd">Dirs</dt>
<dd class="field-odd"><dl class="simple">
<dt>./</dt><dd><p>Main routines</p>
</dd>
</dl>
</dd>
<dt class="field-even">Author</dt>
<dd class="field-even"><p>Ashkbiz Danehkar</p>
</dd>
<dt class="field-odd">Copyright</dt>
<dd class="field-odd"><p>This library is released under a GNU General Public License.</p>
</dd>
<dt class="field-even">Version</dt>
<dd class="field-even"><p>0.3.0</p>
</dd>
<dt class="field-odd">History</dt>
<dd class="field-odd"><p>Based on Effective recombination coefficients for N II lines from
Escalante &amp; Victor 1990ApJS…73..513E.</p>
<p>Adopted from MIDAS Rnii script written by X.W.Liu.</p>
<dl class="simple">
<dt>Revised based on scripts by Yong Zhang added to MOCASSIN, 02/2003</dt><dd><p>Ercolano et al. 2005MNRAS.362.1038E.</p>
</dd>
</dl>
<p>10/05/2013, A. Danehkar, Translated to IDL code.</p>
<p>25/04/2017, A. Danehkar, Integration with AtomNeb.</p>
<dl class="simple">
<dt>10/07/2019, A. Danehkar, Made a new function calc_emiss_n_ii_rl()</dt><dd><p>for calculating line emissivities and separated it
from calc_abund_n_ii_rl().</p>
</dd>
</dl>
<p>03/10/2020, A. Danehkar, Transferred from IDL to Python.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyequib.calc_abund_n_iii_rl">
<code class="sig-prename descclassname">pyequib.</code><code class="sig-name descname">calc_abund_n_iii_rl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">temperature</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">density</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wavelength</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">line_flux</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">n_iii_rc_data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h_i_aeff_data</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyequib.html#calc_abund_n_iii_rl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyequib.calc_abund_n_iii_rl" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><blockquote>
<div><p>This function determines the ionic abundance from the observed
flux intensity for the given wavelength of N III recombination line
by using the recombination coefficients from
Pequignot et al. 1991A&amp;A…251..680P.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>type=double. This function returns the ionic abundanc.</p>
</dd>
<dt class="field-even">Keywords</dt>
<dd class="field-even"><dl class="simple">
<dt>temperature<span class="classifier">in, required, type=float</span></dt><dd><p>electron temperature</p>
</dd>
<dt>density<span class="classifier">in, required, type=float</span></dt><dd><p>electron density</p>
</dd>
<dt>wavelength<span class="classifier">in, required, type=float</span></dt><dd><p>Line Wavelength in Angstrom</p>
</dd>
<dt>line_flux<span class="classifier">in, required, type=float</span></dt><dd><p>line flux intensity</p>
</dd>
<dt>n_iii_rc_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>N III recombination coefficients</p>
</dd>
<dt>h_i_aeff_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>H I recombination coefficients</p>
</dd>
</dl>
</dd>
</dl>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Examples</dt>
<dd class="field-odd"><blockquote>
<div><p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyequib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomneb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="s1">&#39;../externals/atomneb/&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_rc_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;atomic-data-rc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_rc_ppb91_file</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_rc_dir</span><span class="p">,</span> <span class="s1">&#39;rc_PPB91.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_rc_sh95_file</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_rc_dir</span><span class="p">,</span> <span class="s1">&#39;rc_SH95.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;h&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ion</span><span class="o">=</span><span class="s1">&#39;ii&#39;</span> <span class="c1"># H I</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h_i_rc_data</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_aeff_sh95</span><span class="p">(</span><span class="n">atom_rc_sh95_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h_i_aeff_data</span><span class="o">=</span><span class="n">h_i_rc_data</span><span class="p">[</span><span class="s1">&#39;aeff&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ion</span><span class="o">=</span><span class="s1">&#39;iv&#39;</span> <span class="c1"># N III</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_iii_rc_data</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_aeff_ppb91</span><span class="p">(</span><span class="n">atom_rc_ppb91_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">temperature</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">10000.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">density</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">5000.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_iii_4641_flux</span> <span class="o">=</span> <span class="mf">0.245</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelength</span><span class="o">=</span><span class="mf">4640.64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abund_n_iii</span><span class="o">=</span><span class="n">pyequib</span><span class="o">.</span><span class="n">calc_abund_n_iii_rl</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="n">density</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                <span class="n">wavelength</span><span class="o">=</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">line_flux</span><span class="o">=</span><span class="n">n_iii_4641_flux</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                <span class="n">n_iii_rc_data</span><span class="o">=</span><span class="n">n_iii_rc_data</span><span class="p">,</span> <span class="n">h_i_aeff_data</span><span class="o">=</span><span class="n">h_i_aeff_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;N(N^3+)/N(H+):&#39;</span><span class="p">,</span> <span class="n">abund_n_iii</span><span class="p">)</span>
<span class="go">   N(N^3+)/N(H+):    6.3366175e-05</span>
</pre></div>
</div>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Categories</dt>
<dd class="field-odd"><p>Abundance Analysis, Recombination Lines</p>
</dd>
<dt class="field-even">Dirs</dt>
<dd class="field-even"><dl class="simple">
<dt>./</dt><dd><p>Main routines</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Author</dt>
<dd class="field-odd"><p>Ashkbiz Danehkar</p>
</dd>
<dt class="field-even">Copyright</dt>
<dd class="field-even"><p>This library is released under a GNU General Public License.</p>
</dd>
<dt class="field-odd">Version</dt>
<dd class="field-odd"><p>0.3.0</p>
</dd>
<dt class="field-even">History</dt>
<dd class="field-even"><p>Based on  effective radiative recombination coefficients for N III lines from
Pequignot, Petitjean, Boisson, C. 1991A&amp;A…251..680P.</p>
<p>10/05/2013, A. Danehkar, IDL code written.</p>
<p>20/04/2017, A. Danehkar, Integration with AtomNeb.</p>
<dl class="simple">
<dt>10/07/2019, A. Danehkar, Made a new function calc_emiss_n_iii_rl()</dt><dd><p>for calculating line emissivities and separated it
from calc_abund_n_iii_rl().</p>
</dd>
</dl>
<p>03/10/2020, A. Danehkar, Transferred from IDL to Python.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyequib.calc_abund_ne_ii_rl">
<code class="sig-prename descclassname">pyequib.</code><code class="sig-name descname">calc_abund_ne_ii_rl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">temperature</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">density</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wavelength</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">line_flux</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ne_ii_rc_data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h_i_aeff_data</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyequib.html#calc_abund_ne_ii_rl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyequib.calc_abund_ne_ii_rl" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><blockquote>
<div><p>This function determines the ionic abundance from the observed
flux intensity for the given wavelength of Ne II recombination line
by using the recombination coefficients from
Kisielius et al. (1998) &amp; Storey (unpublished).</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>type=double. This function returns the ionic abundanc.</p>
</dd>
<dt class="field-even">Keywords</dt>
<dd class="field-even"><dl class="simple">
<dt>temperature<span class="classifier">in, required, type=float</span></dt><dd><p>electron temperature</p>
</dd>
<dt>density<span class="classifier">in, required, type=float</span></dt><dd><p>electron density</p>
</dd>
<dt>wavelength<span class="classifier">in, required, type=float</span></dt><dd><p>Line Wavelength in Angstrom</p>
</dd>
<dt>line_flux<span class="classifier">in, required, type=float</span></dt><dd><p>line flux intensity</p>
</dd>
<dt>ne_ii_rc_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>Ne II recombination coefficients</p>
</dd>
<dt>h_i_aeff_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>H I recombination coefficients</p>
</dd>
</dl>
</dd>
</dl>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Examples</dt>
<dd class="field-odd"><blockquote>
<div><p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyequib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomneb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="s1">&#39;../externals/atomneb/&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_rc_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;atomic-data-rc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_rc_all_file</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_rc_dir</span><span class="p">,</span> <span class="s1">&#39;rc_collection.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_rc_sh95_file</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_rc_dir</span><span class="p">,</span> <span class="s1">&#39;rc_SH95.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;h&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ion</span><span class="o">=</span><span class="s1">&#39;ii&#39;</span> <span class="c1"># H I</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h_i_rc_data</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_aeff_sh95</span><span class="p">(</span><span class="n">atom_rc_sh95_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h_i_aeff_data</span><span class="o">=</span><span class="n">h_i_rc_data</span><span class="p">[</span><span class="s1">&#39;aeff&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;ne&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ion</span><span class="o">=</span><span class="s1">&#39;iii&#39;</span> <span class="c1"># Ne II</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ne_ii_rc_data</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_aeff_collection</span><span class="p">(</span><span class="n">atom_rc_all_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">temperature</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">10000.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">density</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">5000.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ne_ii_3777_flux</span> <span class="o">=</span> <span class="mf">0.056</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelength</span><span class="o">=</span><span class="mf">3777.14</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abund_ne_ii</span><span class="o">=</span><span class="n">pyequib</span><span class="o">.</span><span class="n">calc_abund_ne_ii_rl</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="n">density</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                <span class="n">wavelength</span><span class="o">=</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">line_flux</span><span class="o">=</span><span class="n">ne_ii_3777_flux</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                <span class="n">ne_ii_rc_data</span><span class="o">=</span><span class="n">ne_ii_rc_data</span><span class="p">,</span> <span class="n">h_i_aeff_data</span><span class="o">=</span><span class="n">h_i_aeff_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;N(Ne^2+)/N(H+):&#39;</span><span class="p">,</span> <span class="n">abund_ne_ii</span><span class="p">)</span>
<span class="go">   N(Ne^2+)/N(H+):    0.00043376850</span>
</pre></div>
</div>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Categories</dt>
<dd class="field-odd"><p>Abundance Analysis, Recombination Lines</p>
</dd>
<dt class="field-even">Dirs</dt>
<dd class="field-even"><dl class="simple">
<dt>./</dt><dd><p>Main routines</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Author</dt>
<dd class="field-odd"><p>Ashkbiz Danehkar</p>
</dd>
<dt class="field-even">Copyright</dt>
<dd class="field-even"><p>This library is released under a GNU General Public License.</p>
</dd>
<dt class="field-odd">Version</dt>
<dd class="field-odd"><p>0.3.0</p>
</dd>
<dt class="field-even">History</dt>
<dd class="field-even"><p>Based on effective radiative recombination coefficients for Ne II lines
from Kisielius et al. 1998A&amp;AS..133..257K &amp; Storey (unpublished).</p>
<p>Adopted from MOCASSIN, Ercolano et al. 2005MNRAS.362.1038E.</p>
<p>02/2003, Yong Zhang, scripts added to MOCASSIN.</p>
<p>14/05/2013, A. Danehkar, Translated to IDL code.</p>
<p>10/04/2017, A. Danehkar, Integration with AtomNeb.</p>
<dl class="simple">
<dt>10/07/2019, A. Danehkar, Made a new function calc_emiss_ne_ii_rl()</dt><dd><p>for calculating line emissivities and separated it
from calc_abund_ne_ii_rl().</p>
</dd>
</dl>
<p>03/10/2020, A. Danehkar, Transferred from IDL to Python.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyequib.calc_abund_o_ii_rl">
<code class="sig-prename descclassname">pyequib.</code><code class="sig-name descname">calc_abund_o_ii_rl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">temperature</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">density</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wavelength</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">line_flux</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">o_ii_rc_br</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">o_ii_rc_data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h_i_aeff_data</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyequib.html#calc_abund_o_ii_rl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyequib.calc_abund_o_ii_rl" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This function determines the ionic abundance from the observed
flux intensity for the given wavelength of O II recombination line
by using the recombination coefficients from
Storey 1994A&amp;A…282..999S and Liu et al. 1995MNRAS.272..369L.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>type=double. This function returns the ionic abundanc.</p>
</dd>
<dt class="field-even">Keywords</dt>
<dd class="field-even"><dl class="simple">
<dt>temperature<span class="classifier">in, required, type=float</span></dt><dd><p>electron temperature</p>
</dd>
<dt>density<span class="classifier">in, required, type=float</span></dt><dd><p>electron density</p>
</dd>
<dt>wavelength<span class="classifier">in, required, type=float</span></dt><dd><p>Line Wavelength in Angstrom</p>
</dd>
<dt>line_flux<span class="classifier">in, required, type=float</span></dt><dd><p>line flux intensity</p>
</dd>
<dt>o_ii_rc_br<span class="classifier">in, required, type=array/object</span></dt><dd><p>O II branching ratios (Br)</p>
</dd>
<dt>o_ii_rc_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>O II recombination coefficients</p>
</dd>
<dt>h_i_aeff_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>H I recombination coefficients</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Examples</dt>
<dd class="field-odd"><p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyequib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomneb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="s1">&#39;../externals/atomneb/&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_rc_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;atomic-data-rc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_rc_all_file</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_rc_dir</span><span class="p">,</span> <span class="s1">&#39;rc_collection.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_rc_sh95_file</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_rc_dir</span><span class="p">,</span> <span class="s1">&#39;rc_SH95.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;h&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ion</span><span class="o">=</span><span class="s1">&#39;ii&#39;</span> <span class="c1"># H I</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h_i_rc_data</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_aeff_sh95</span><span class="p">(</span><span class="n">atom_rc_sh95_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h_i_aeff_data</span><span class="o">=</span><span class="n">h_i_rc_data</span><span class="p">[</span><span class="s1">&#39;aeff&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;o&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ion</span><span class="o">=</span><span class="s1">&#39;iii&#39;</span> <span class="c1"># O II</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o_ii_rc_data</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_aeff_collection</span><span class="p">(</span><span class="n">atom_rc_all_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o_ii_rc_data_br</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_aeff_collection</span><span class="p">(</span><span class="n">atom_rc_all_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">,</span> <span class="n">br</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">temperature</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">10000.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">density</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">5000.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o_ii_4614_flux</span> <span class="o">=</span> <span class="mf">0.009</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelength</span><span class="o">=</span><span class="mf">4613.68</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abund_o_ii</span><span class="o">=</span><span class="n">pyequib</span><span class="o">.</span><span class="n">calc_abund_o_ii_rl</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="n">density</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">wavelength</span><span class="o">=</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">line_flux</span><span class="o">=</span><span class="n">o_ii_4614_flux</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">o_ii_rc_br</span><span class="o">=</span><span class="n">o_ii_rc_data_br</span><span class="p">,</span> <span class="n">o_ii_rc_data</span><span class="o">=</span><span class="n">o_ii_rc_data</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">h_i_aeff_data</span><span class="o">=</span><span class="n">h_i_aeff_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;N(O^2+)/N(H+):&#39;</span><span class="p">,</span> <span class="n">abund_o_ii</span><span class="p">)</span>
<span class="go">   N(O^2+)/N(H+):    0.0018886330</span>
</pre></div>
</div>
</dd>
<dt class="field-even">Categories</dt>
<dd class="field-even"><p>Abundance Analysis, Recombination Lines</p>
</dd>
<dt class="field-odd">Dirs</dt>
<dd class="field-odd"><dl class="simple">
<dt>./</dt><dd><p>Main routines</p>
</dd>
</dl>
</dd>
<dt class="field-even">Author</dt>
<dd class="field-even"><p>Ashkbiz Danehkar</p>
</dd>
<dt class="field-odd">Copyright</dt>
<dd class="field-odd"><p>This library is released under a GNU General Public License.</p>
</dd>
<dt class="field-even">Version</dt>
<dd class="field-even"><p>0.3.0</p>
</dd>
<dt class="field-odd">History</dt>
<dd class="field-odd"><p>Based on recombination coefficients for O II lines from
Storey 1994A&amp;A…282..999S and Liu et al. 1995MNRAS.272..369L.</p>
<p>Adopted from MIDAS script Roii.prg written by X.W.Liu.</p>
<dl class="simple">
<dt>Revised based on scripts by Yong Zhang added to MOCASSIN, 02/2003</dt><dd><p>Ercolano et al. 2005MNRAS.362.1038E.</p>
</dd>
</dl>
<p>10/05/2013, A. Danehkar, Translated to IDL code.</p>
<p>25/04/2017, A. Danehkar, Integration with AtomNeb.</p>
<dl class="simple">
<dt>10/07/2019, A. Danehkar, Made a new function calc_emiss_o_ii_rl()</dt><dd><p>for calculating line emissivities and separated it
from calc_abund_o_ii_rl().</p>
</dd>
</dl>
<p>03/10/2020, A. Danehkar, Transferred from IDL to Python.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyequib.calc_abundance">
<code class="sig-prename descclassname">pyequib.</code><code class="sig-name descname">calc_abundance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">temperature</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">density</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">line_flux</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">atomic_levels</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">elj_data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">omij_data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">aij_data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h_i_aeff_data</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyequib.html#calc_abundance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyequib.calc_abundance" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This function determines the ionic abundance from the observed
flux intensity for specified ion with level(s)
by solving atomic level populations and
line emissivities in statistical equilibrium
for given electron density and temperature.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>type=double. This function returns the ionic abundanc.</p>
</dd>
<dt class="field-even">Keywords</dt>
<dd class="field-even"><dl class="simple">
<dt>temperature<span class="classifier">in, required, type=float</span></dt><dd><p>electron temperature</p>
</dd>
<dt>density<span class="classifier">in, required, type=float</span></dt><dd><p>electron density</p>
</dd>
<dt>line_flux<span class="classifier">in, required, type=float</span></dt><dd><p>line flux intensity</p>
</dd>
<dt>atomic_levels<span class="classifier">in, required, type=string</span></dt><dd><p>level(s) e.g ‘1,2/’, ‘1,2,1,3/’</p>
</dd>
<dt>elj_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>energy levels (Ej) data</p>
</dd>
<dt>omij_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>collision strengths (omega_ij) data</p>
</dd>
<dt>aij_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>transition probabilities (Aij) data</p>
</dd>
<dt>h_i_aeff_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>H I recombination coefficients</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Examples</dt>
<dd class="field-odd"><p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyequib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomneb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="s1">&#39;../externals/atomneb/&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;atomic-data&#39;</span><span class="p">,</span> <span class="s1">&#39;chianti70&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_elj_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;AtomElj.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_omij_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;AtomOmij.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_aij_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;AtomAij.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_rc_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;atomic-data-rc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_rc_sh95_file</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_rc_dir</span><span class="p">,</span> <span class="s1">&#39;rc_SH95.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;o&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ion</span><span class="o">=</span><span class="s1">&#39;iii&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o_iii_elj</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_elj</span><span class="p">(</span><span class="n">atom_elj_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">,</span> <span class="n">level_num</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># read Energy Levels (Ej)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o_iii_omij</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_omij</span><span class="p">(</span><span class="n">atom_omij_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span> <span class="c1"># read Collision Strengths (Omegaij)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o_iii_aij</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_aij</span><span class="p">(</span><span class="n">atom_aij_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span> <span class="c1"># read Transition Probabilities (Aij)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;h&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ion</span><span class="o">=</span><span class="s1">&#39;ii&#39;</span> <span class="c1"># H I</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hi_rc_data</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_aeff_sh95</span><span class="p">(</span><span class="n">atom_rc_sh95_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h_i_aeff_data</span><span class="o">=</span><span class="n">hi_rc_data</span><span class="p">[</span><span class="s1">&#39;aeff&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">temperature</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">10000.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">density</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">5000.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atomic_levels</span><span class="o">=</span><span class="s1">&#39;3,4/&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iobs5007</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">1200.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abb5007</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abb5007</span><span class="o">=</span><span class="n">pyequib</span><span class="o">.</span><span class="n">calc_abundance</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="n">density</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="n">line_flux</span><span class="o">=</span><span class="n">iobs5007</span><span class="p">,</span> <span class="n">atomic_levels</span><span class="o">=</span><span class="n">atomic_levels</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="n">elj_data</span><span class="o">=</span><span class="n">o_iii_elj</span><span class="p">,</span> <span class="n">omij_data</span><span class="o">=</span><span class="n">o_iii_omij</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="n">aij_data</span><span class="o">=</span><span class="n">o_iii_aij</span><span class="p">,</span> <span class="n">h_i_aeff_data</span><span class="o">=</span><span class="n">hi_rc_data</span><span class="p">[</span><span class="s1">&#39;aeff&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;N(O^2+)/N(H+):&#39;</span><span class="p">,</span> <span class="n">abb5007</span><span class="p">)</span>
<span class="go">   N(O^2+)/N(H+):   0.00041256231</span>
</pre></div>
</div>
</dd>
<dt class="field-even">Categories</dt>
<dd class="field-even"><p>Abundance Analysis, Collisionally Excited Lines</p>
</dd>
<dt class="field-odd">Dirs</dt>
<dd class="field-odd"><dl class="simple">
<dt>./</dt><dd><p>Main routines</p>
</dd>
</dl>
</dd>
<dt class="field-even">Author</dt>
<dd class="field-even"><p>Ashkbiz Danehkar</p>
</dd>
<dt class="field-odd">Copyright</dt>
<dd class="field-odd"><p>This library is released under a GNU General Public License.</p>
</dd>
<dt class="field-even">Version</dt>
<dd class="field-even"><p>0.3.0</p>
</dd>
<dt class="field-odd">History</dt>
<dd class="field-odd"><p>15/09/2013, A. Danehkar, Translated from FORTRAN to IDL code.</p>
<p>20/10/2016, A. Danehkar, Replaced str2int with strnumber.</p>
<dl class="simple">
<dt>20/10/2016, A. Danehkar, Replaced CFY, SPLMAT, and CFD with</dt><dd><p>IDL function INTERPOL( /SPLINE).</p>
</dd>
<dt>20/10/2016, A. Danehkar, Replaced LUSLV with IDL LAPACK function</dt><dd><p>LA_LINEAR_EQUATION.</p>
</dd>
<dt>15/11/2016, A. Danehkar, Replaced LA_LINEAR_EQUATION (not work in GDL)</dt><dd><p>with IDL function LUDC &amp; LUSOL.</p>
</dd>
<dt>19/11/2016, A. Danehkar, Replaced INTERPOL (not accurate) with</dt><dd><p>SPL_INIT &amp; SPL_INTERP.</p>
</dd>
<dt>20/11/2016, A. Danehkar, Made a new function calc_populations()</dt><dd><p>for solving atomic level populations and separated it from
calc_abundance(), calc_density() and calc_temperature().</p>
</dd>
<dt>21/11/2016, A. Danehkar, Made a new function calc_emissivity()</dt><dd><p>for calculating line emissivities and separated it
from calc_abundance().</p>
</dd>
<dt>10/03/2017, A. Danehkar, Integration with AtomNeb, now uses atomic data</dt><dd><p>input elj_data, omij_data, aij_data.</p>
</dd>
<dt>12/06/2017, A. Danehkar, Cleaning the function, and remove unused varibales</dt><dd><p>from calc_abundance().</p>
</dd>
</dl>
<p>03/10/2020, A. Danehkar, Transferred from IDL to Python.</p>
</dd>
</dl>
<p>FORTRAN HISTORY:</p>
<blockquote>
<div><p>03/05/1981, I.D.Howarth,  Version 1.</p>
<p>05/05/1981, I.D.Howarth,  Minibug fixed!</p>
<p>07/05/1981, I.D.Howarth,  Now takes collision rates or strengths.</p>
<p>03/08/1981, S.Adams,      Interpolates collision strengths.</p>
<p>07/08/1981, S.Adams,      Input method changed.</p>
<dl class="simple">
<dt>19/11/1984, R.E.S.Clegg,  SA files entombed in scratch disk. Logical</dt><dd><p>filenames given to SA’s data files.</p>
</dd>
</dl>
<p>08/1995, D.P.Ruffle, Changed input file format. Increased matrices.</p>
<dl class="simple">
<dt>02/1996, X.W.Liu,   Tidy up. SUBROUTINES SPLMAT, HGEN, CFY and CFD</dt><dd><p>modified such that matrix sizes (i.e. maximum
of Te and maximum no of levels) can now be cha
by modifying the parameters NDIM1, NDIM2 and N
in the Main program. EASY!
Now takes collision rates as well.
All variables are declared explicitly
Generate two extra files (ionpop.lis and ionra
of plain stream format for plotting.</p>
</dd>
<dt>06/1996, C.J.Pritchet, Changed input data format for cases IBIG=1,2.</dt><dd><p>Fixed readin bug for IBIG=2 case.
Now reads reformatted upsilons (easier to see
and the 0 0 0 data end is excluded for these c
The A values have a different format for IBIG=.</p>
</dd>
</dl>
<p>2006, B.Ercolano,   Converted to F90.</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt id="pyequib.calc_crit_density">
<code class="sig-prename descclassname">pyequib.</code><code class="sig-name descname">calc_crit_density</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">temperature</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">elj_data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">omij_data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">aij_data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">level_num</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">irats</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyequib.html#calc_crit_density"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyequib.calc_crit_density" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This function calculates critical densities in statistical equilibrium
for given electron temperature.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>type=array/object. This function returns the critical densities.</p>
</dd>
<dt class="field-even">Keywords</dt>
<dd class="field-even"><dl class="simple">
<dt>temperature<span class="classifier">in, required, type=float</span></dt><dd><p>electron temperature</p>
</dd>
<dt>elj_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>energy levels (Ej) data</p>
</dd>
<dt>omij_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>collision strengths (omega_ij) data</p>
</dd>
<dt>aij_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>transition probabilities (Aij) data</p>
</dd>
<dt>level_num<span class="classifier">in, type=int</span></dt><dd><p>Number of levels</p>
</dd>
<dt>irats<span class="classifier">in, type=int</span></dt><dd><p>Else Coll. rates = tabulated values * 10 ** irats</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Examples</dt>
<dd class="field-odd"><p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyequib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomneb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="s1">&#39;../externals/atomneb/&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;atomic-data&#39;</span><span class="p">,</span> <span class="s1">&#39;chianti70&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_elj_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;AtomElj.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_omij_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;AtomOmij.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_aij_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;AtomAij.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;s&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ion</span><span class="o">=</span><span class="s1">&#39;ii&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_ii_elj</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_elj</span><span class="p">(</span><span class="n">atom_elj_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">,</span> <span class="n">level_num</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># read Energy Levels (Ej)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_ii_omij</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_omij</span><span class="p">(</span><span class="n">atom_omij_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span> <span class="c1"># read Collision Strengths (Omegaij)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_ii_aij</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_aij</span><span class="p">(</span><span class="n">atom_aij_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span> <span class="c1"># read Transition Probabilities (Aij)        &gt;&gt;&gt; temperature=np.float64(10000.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_crit</span><span class="o">=</span><span class="n">pyequib</span><span class="o">.</span><span class="n">calc_crit_density</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                         <span class="n">elj_data</span><span class="o">=</span><span class="n">s_ii_elj</span><span class="p">,</span> <span class="n">omij_data</span><span class="o">=</span><span class="n">s_ii_omij</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                         <span class="n">aij_data</span><span class="o">=</span><span class="n">s_ii_aij</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Critical Densities:&#39;</span><span class="p">,</span> <span class="n">n_crit</span><span class="p">)</span>
<span class="go">   Critical Densities:       0.0000000       5007.8396       1732.8414       1072685.0       2220758.1</span>
</pre></div>
</div>
</dd>
<dt class="field-even">Categories</dt>
<dd class="field-even"><p>Plasma Diagnostics, Abundance Analysis, Collisionally Excited Lines</p>
</dd>
<dt class="field-odd">Dirs</dt>
<dd class="field-odd"><dl class="simple">
<dt>./</dt><dd><p>Main routines</p>
</dd>
</dl>
</dd>
<dt class="field-even">Author</dt>
<dd class="field-even"><p>Ashkbiz Danehkar</p>
</dd>
<dt class="field-odd">Copyright</dt>
<dd class="field-odd"><p>This library is released under a GNU General Public License.</p>
</dd>
<dt class="field-even">Version</dt>
<dd class="field-even"><p>0.3.0</p>
</dd>
<dt class="field-odd">History</dt>
<dd class="field-odd"><p>15/09/2013, A. Danehkar, Translated from FORTRAN to IDL code.</p>
<p>20/10/2016, A. Danehkar, Replaced str2int with strnumber.</p>
<dl class="simple">
<dt>20/10/2016, A. Danehkar, Replaced CFY, SPLMAT, and CFD with</dt><dd><p>IDL function INTERPOL( /SPLINE).</p>
</dd>
<dt>20/10/2016, A. Danehkar, Replaced LUSLV with IDL LAPACK function</dt><dd><p>LA_LINEAR_EQUATION.</p>
</dd>
<dt>15/11/2016, A. Danehkar, Replaced LA_LINEAR_EQUATION (not work in GDL)</dt><dd><p>with IDL function LUDC &amp; LUSOL.</p>
</dd>
<dt>19/11/2016, A. Danehkar, Replaced INTERPOL (not accurate) with</dt><dd><p>SPL_INIT &amp; SPL_INTERP.</p>
</dd>
<dt>20/11/2016, A. Danehkar, Made a new function calc_populations()</dt><dd><p>for solving atomic level populations and separated it from
calc_abundance(), calc_density() and calc_temperature().</p>
</dd>
<dt>10/03/2017, A. Danehkar, Integration with AtomNeb, now uses atomic data</dt><dd><p>input elj_data, omij_data, aij_data.</p>
</dd>
<dt>12/06/2017, A. Danehkar, Cleaning the function, and remove unused varibales</dt><dd><p>from calc_populations().</p>
</dd>
<dt>27/02/2019, A. Danehkar, Simplify the calc_populations() routine</dt><dd><p>for external usage.</p>
</dd>
<dt>01/03/2019, A. Danehkar, Create the calc_crit_density() routine</dt><dd><p>from the calc_populations() routine.</p>
</dd>
</dl>
<p>04/03/2019, A. Danehkar, Use the get_omij_temp() routine.</p>
<p>03/10/2020, A. Danehkar, Transferred from IDL to Python.</p>
</dd>
</dl>
<p>FORTRAN HISTORY:</p>
<blockquote>
<div><p>03/05/1981, I.D.Howarth,  Version 1.</p>
<p>05/05/1981, I.D.Howarth,  Minibug fixed!</p>
<p>07/05/1981, I.D.Howarth,  Now takes collision rates or strengths.</p>
<p>03/08/1981, S.Adams,      Interpolates collision strengths.</p>
<p>07/08/1981, S.Adams,      Input method changed.</p>
<dl class="simple">
<dt>19/11/1984, R.E.S.Clegg,  SA files entombed in scratch disk. Logical</dt><dd><p>filenames given to SA’s data files.</p>
</dd>
</dl>
<p>08/1995, D.P.Ruffle, Changed input file format. Increased matrices.</p>
<dl class="simple">
<dt>02/1996, X.W.Liu,   Tidy up. SUBROUTINES SPLMAT, HGEN, CFY and CFD</dt><dd><p>modified such that matrix sizes (i.e. maximum
of Te and maximum no of levels) can now be cha
by modifying the parameters NDIM1, NDIM2 and N
in the Main program. EASY!
Now takes collision rates as well.
All variables are declared explicitly
Generate two extra files (ionpop.lis and ionra
of plain stream format for plotting.</p>
</dd>
<dt>06/1996, C.J.Pritchet, Changed input data format for cases IBIG=1,2.</dt><dd><p>Fixed readin bug for IBIG=2 case.
Now reads reformatted upsilons (easier to see
and the 0 0 0 data end is excluded for these c
The A values have a different format for IBIG=.</p>
</dd>
</dl>
<p>2006, B.Ercolano,   Converted to F90.</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt id="pyequib.calc_density">
<code class="sig-prename descclassname">pyequib.</code><code class="sig-name descname">calc_density</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">line_flux_ratio</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">temperature</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">upper_levels</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lower_levels</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">elj_data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">omij_data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">aij_data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">low_density</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">high_density</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">num_density</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">min_temperature</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyequib.html#calc_density"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyequib.calc_density" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This function determines electron density from given
flux intensity ratio for specified ion with upper level(s)
lower level(s) by solving atomic level populations and
line emissivities in statistical equilibrium
for given electron temperature.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>type=double. This function returns the electron density.</p>
</dd>
<dt class="field-even">Keywords</dt>
<dd class="field-even"><dl class="simple">
<dt>line_flux_ratio<span class="classifier">in, required, type=float</span></dt><dd><p>flux intensity ratio</p>
</dd>
<dt>temperature<span class="classifier">in, required, type=float</span></dt><dd><p>electron temperature</p>
</dd>
<dt>upper_levels<span class="classifier">in, required, type=string</span></dt><dd><p>upper atomic level(s) e.g ‘1,2/’, ‘1,2,1,3/’</p>
</dd>
<dt>lower_levels<span class="classifier">in, required, type=string</span></dt><dd><p>lower atomic level(s) e.g ‘1,2/’, ‘1,2,1,3/’</p>
</dd>
<dt>elj_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>energy levels (Ej) data</p>
</dd>
<dt>omij_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>collision strengths (omega_ij) data</p>
</dd>
<dt>aij_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>transition probabilities (Aij) data</p>
</dd>
<dt>low_density<span class="classifier">in, optional, type=float</span></dt><dd><p>lower density range</p>
</dd>
<dt>high_density<span class="classifier">in, optional, type=float</span></dt><dd><p>upper density range</p>
</dd>
<dt>num_density<span class="classifier">in, optional, type=integer</span></dt><dd><p>number of the iteration step</p>
</dd>
<dt>min_temperature<span class="classifier">in, optional, type=float</span></dt><dd><p>minimum temperature</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Examples</dt>
<dd class="field-odd"><p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyequib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomneb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="s1">&#39;../externals/atomneb/&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;atomic-data&#39;</span><span class="p">,</span> <span class="s1">&#39;chianti70&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_elj_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;AtomElj.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_omij_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;AtomOmij.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_aij_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;AtomAij.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;s&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ion</span><span class="o">=</span><span class="s1">&#39;ii&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_ii_elj</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_elj</span><span class="p">(</span><span class="n">atom_elj_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">,</span> <span class="n">level_num</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># read Energy Levels (Ej)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_ii_omij</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_omij</span><span class="p">(</span><span class="n">atom_omij_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span> <span class="c1"># read Collision Strengths (Omegaij)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_ii_aij</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_aij</span><span class="p">(</span><span class="n">atom_aij_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span> <span class="c1"># read Transition Probabilities (Aij)        &gt;&gt;&gt; upper_levels=&#39;1,2/&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lower_levels</span><span class="o">=</span><span class="s1">&#39;1,3/&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">temperature</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">7000.0</span><span class="p">)</span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">line_flux_ratio</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">1.506</span><span class="p">)</span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">density</span><span class="o">=</span><span class="n">pyequib</span><span class="o">.</span><span class="n">calc_density</span><span class="p">(</span><span class="n">line_flux_ratio</span><span class="o">=</span><span class="n">line_flux_ratio</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                     <span class="n">upper_levels</span><span class="o">=</span><span class="n">upper_levels</span><span class="p">,</span> <span class="n">lower_levels</span><span class="o">=</span><span class="n">lower_levels</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                     <span class="n">elj_data</span><span class="o">=</span><span class="n">s_ii_elj</span><span class="p">,</span> <span class="n">omij_data</span><span class="o">=</span><span class="n">s_ii_omij</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                     <span class="n">aij_data</span><span class="o">=</span><span class="n">s_ii_aij</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Electron Density:&quot;</span><span class="p">,</span> <span class="n">density</span><span class="p">)</span>
<span class="go">   Electron Density:       2312.6395</span>
</pre></div>
</div>
</dd>
<dt class="field-even">Categories</dt>
<dd class="field-even"><p>Plasma Diagnostics, Collisionally Excited Lines</p>
</dd>
<dt class="field-odd">Dirs</dt>
<dd class="field-odd"><dl class="simple">
<dt>./</dt><dd><p>Main routines</p>
</dd>
</dl>
</dd>
<dt class="field-even">Author</dt>
<dd class="field-even"><p>Ashkbiz Danehkar</p>
</dd>
<dt class="field-odd">Copyright</dt>
<dd class="field-odd"><p>This library is released under a GNU General Public License.</p>
</dd>
<dt class="field-even">Version</dt>
<dd class="field-even"><p>0.3.0</p>
</dd>
<dt class="field-odd">History</dt>
<dd class="field-odd"><p>15/09/2013, A. Danehkar, Translated from FORTRAN to IDL code.</p>
<p>20/10/2016, A. Danehkar, Replaced str2int with strnumber.</p>
<dl class="simple">
<dt>20/10/2016, A. Danehkar, Replaced CFY, SPLMAT, and CFD with</dt><dd><p>IDL function INTERPOL( /SPLINE).</p>
</dd>
<dt>20/10/2016, A. Danehkar, Replaced LUSLV with IDL LAPACK function</dt><dd><p>LA_LINEAR_EQUATION.</p>
</dd>
<dt>15/11/2016, A. Danehkar, Replaced LA_LINEAR_EQUATION (not work in GDL)</dt><dd><p>with IDL function LUDC &amp; LUSOL.</p>
</dd>
<dt>19/11/2016, A. Danehkar, Replaced INTERPOL (not accurate) with</dt><dd><p>SPL_INIT &amp; SPL_INTERP.</p>
</dd>
<dt>20/11/2016, A. Danehkar, Made a new function calc_populations()</dt><dd><p>for solving atomic level populations and separated it from
calc_abundance(), calc_density() and calc_temperature().</p>
</dd>
<dt>10/03/2017, A. Danehkar, Integration with AtomNeb, now uses atomic data</dt><dd><p>input elj_data, omij_data, aij_data.</p>
</dd>
<dt>12/06/2017, A. Danehkar, Cleaning the function, and remove unused varibales</dt><dd><p>from calc_density().</p>
</dd>
<dt>27/02/2019, A. Danehkar, Fix a bug in the atomic level assumption, and</dt><dd><p>use the simplified calc_populations() routine.</p>
</dd>
</dl>
<p>04/03/2019, A. Danehkar, Use the get_omij_temp() routine.</p>
<p>24/05/2019, A. Danehkar, Add the optional density range.</p>
<p>03/10/2020, A. Danehkar, Transferred from IDL to Python.</p>
</dd>
</dl>
<p>FORTRAN HISTORY:</p>
<blockquote>
<div><p>03/05/1981, I.D.Howarth,  Version 1.</p>
<p>05/05/1981, I.D.Howarth,  Minibug fixed!</p>
<p>07/05/1981, I.D.Howarth,  Now takes collision rates or strengths.</p>
<p>03/08/1981, S.Adams,      Interpolates collision strengths.</p>
<p>07/08/1981, S.Adams,      Input method changed.</p>
<dl class="simple">
<dt>19/11/1984, R.E.S.Clegg,  SA files entombed in scratch disk. Logical</dt><dd><p>filenames given to SA’s data files.</p>
</dd>
</dl>
<p>08/1995, D.P.Ruffle, Changed input file format. Increased matrices.</p>
<dl class="simple">
<dt>02/1996, X.W.Liu,   Tidy up. SUBROUTINES SPLMAT, HGEN, CFY and CFD</dt><dd><p>modified such that matrix sizes (i.e. maximum
of Te and maximum no of levels) can now be cha
by modifying the parameters NDIM1, NDIM2 and N
in the Main program. EASY!
Now takes collision rates as well.
All variables are declared explicitly
Generate two extra files (ionpop.lis and ionra
of plain stream format for plotting.</p>
</dd>
<dt>06/1996, C.J.Pritchet, Changed input data format for cases IBIG=1,2.</dt><dd><p>Fixed readin bug for IBIG=2 case.
Now reads reformatted upsilons (easier to see
and the 0 0 0 data end is excluded for these c
The A values have a different format for IBIG=.</p>
</dd>
</dl>
<p>2006, B.Ercolano,   Converted to F90.</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt id="pyequib.calc_emiss_c_ii_rl">
<code class="sig-prename descclassname">pyequib.</code><code class="sig-name descname">calc_emiss_c_ii_rl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">temperature</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">density</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wavelength</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">c_ii_rc_data</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyequib.html#calc_emiss_c_ii_rl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyequib.calc_emiss_c_ii_rl" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This function calculates the emissivity
for the given wavelength of C II recombination line
by using the recombination coefficients from
from Davey et al. (2000) 2000A&amp;AS..142…85D.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>type=double. This function returns the line emissivity.</p>
</dd>
<dt class="field-even">Keywords</dt>
<dd class="field-even"><dl class="simple">
<dt>temperature<span class="classifier">in, required, type=float</span></dt><dd><p>electron temperature</p>
</dd>
<dt>density<span class="classifier">in, required, type=float</span></dt><dd><p>electron density</p>
</dd>
<dt>wavelength<span class="classifier">in, required, type=float</span></dt><dd><p>Line Wavelength in Angstrom</p>
</dd>
<dt>c_ii_rc_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>C II recombination coefficients</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Examples</dt>
<dd class="field-odd"><p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyequib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomneb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="s1">&#39;../externals/atomneb/&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_rc_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;atomic-data-rc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_rc_all_file</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_rc_dir</span><span class="p">,</span> <span class="s1">&#39;rc_collection.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_rc_sh95_file</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_rc_dir</span><span class="p">,</span> <span class="s1">&#39;rc_SH95.fits&#39;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;c&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ion</span><span class="o">=</span><span class="s1">&#39;iii&#39;</span> <span class="c1"># C II</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c_ii_rc_data</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_aeff_collection</span><span class="p">(</span><span class="n">atom_rc_all_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">temperature</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">10000.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">density</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">5000.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelength</span><span class="o">=</span><span class="mf">6151.43</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">emiss_c_ii</span><span class="o">=</span><span class="n">pyequib</span><span class="o">.</span><span class="n">calc_emiss_c_ii_rl</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="n">density</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">wavelength</span><span class="o">=</span><span class="n">wavelength</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">c_ii_rc_data</span><span class="o">=</span><span class="n">c_ii_rc_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Emissivity:&#39;</span><span class="p">,</span> <span class="n">emiss_c_ii</span><span class="p">)</span>
<span class="go">   Emissivity:   5.4719511e-26</span>
</pre></div>
</div>
</dd>
<dt class="field-even">Categories</dt>
<dd class="field-even"><p>Abundance Analysis, Recombination Lines, Emissivity</p>
</dd>
<dt class="field-odd">Dirs</dt>
<dd class="field-odd"><dl class="simple">
<dt>./</dt><dd><p>Main routines</p>
</dd>
</dl>
</dd>
<dt class="field-even">Author</dt>
<dd class="field-even"><p>Ashkbiz Danehkar</p>
</dd>
<dt class="field-odd">Copyright</dt>
<dd class="field-odd"><p>This library is released under a GNU General Public License.</p>
</dd>
<dt class="field-even">Version</dt>
<dd class="field-even"><p>0.3.0</p>
</dd>
<dt class="field-odd">History</dt>
<dd class="field-odd"><p>Based on recombination coefficients for C II lines from
Davey et al. 2000A&amp;AS..142…85D.</p>
<p>Adopted from MOCASSIN, Ercolano et al. 2005MNRAS.362.1038E.</p>
<p>02/2003, Yong Zhang, added to MOCASSIN.</p>
<p>10/05/2013, A. Danehkar, Translated to IDL code.</p>
<p>15/04/2017, A. Danehkar, Integration with AtomNeb.</p>
<dl class="simple">
<dt>10/07/2019, A. Danehkar, Made a new function calc_emiss_c_ii_rl()</dt><dd><p>for calculating line emissivities and separated it
from calc_abund_c_ii_rl().</p>
</dd>
</dl>
<p>03/10/2020, A. Danehkar, Transferred from IDL to Python.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyequib.calc_emiss_c_iii_rl">
<code class="sig-prename descclassname">pyequib.</code><code class="sig-name descname">calc_emiss_c_iii_rl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">temperature</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">density</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wavelength</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">c_iii_rc_data</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyequib.html#calc_emiss_c_iii_rl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyequib.calc_emiss_c_iii_rl" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><blockquote>
<div><p>This function calculates the emissivity
for the given wavelength of C III recombination line
by using the recombination coefficients from
Pequignot et al. 1991A&amp;A…251..680P.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>type=double. This function returns the line emissivity.</p>
</dd>
<dt class="field-even">Keywords</dt>
<dd class="field-even"><dl class="simple">
<dt>temperature<span class="classifier">in, required, type=float</span></dt><dd><p>electron temperature</p>
</dd>
<dt>density<span class="classifier">in, required, type=float</span></dt><dd><p>electron density</p>
</dd>
<dt>wavelength<span class="classifier">in, required, type=float</span></dt><dd><p>Line Wavelength in Angstrom</p>
</dd>
<dt>c_iii_rc_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>C III recombination coefficients</p>
</dd>
</dl>
</dd>
</dl>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Examples</dt>
<dd class="field-odd"><blockquote>
<div><p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyequib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomneb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="s1">&#39;../externals/atomneb/&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_rc_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;atomic-data-rc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_rc_ppb91_file</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_rc_dir</span><span class="p">,</span> <span class="s1">&#39;rc_PPB91.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_rc_sh95_file</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_rc_dir</span><span class="p">,</span> <span class="s1">&#39;rc_SH95.fits&#39;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;c&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ion</span><span class="o">=</span><span class="s1">&#39;iv&#39;</span> <span class="c1"># C III</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c_iii_rc_data</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_aeff_ppb91</span><span class="p">(</span><span class="n">atom_rc_ppb91_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">temperature</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">10000.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">density</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">5000.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelength</span><span class="o">=</span><span class="mf">4647.42</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">emiss_c_iii</span><span class="o">=</span><span class="n">pyequib</span><span class="o">.</span><span class="n">calc_emiss_c_iii_rl</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="n">density</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                <span class="n">wavelength</span><span class="o">=</span><span class="n">wavelength</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                <span class="n">c_iii_rc_data</span><span class="o">=</span><span class="n">c_iii_rc_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Emissivity:&#39;</span><span class="p">,</span> <span class="n">emiss_c_iii</span><span class="p">)</span>
<span class="go">   Emissivity:   7.5749632e-25</span>
</pre></div>
</div>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Categories</dt>
<dd class="field-odd"><p>Abundance Analysis, Recombination Lines, Emissivity</p>
</dd>
<dt class="field-even">Dirs</dt>
<dd class="field-even"><dl class="simple">
<dt>./</dt><dd><p>Main routines</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Author</dt>
<dd class="field-odd"><p>Ashkbiz Danehkar</p>
</dd>
<dt class="field-even">Copyright</dt>
<dd class="field-even"><p>This library is released under a GNU General Public License.</p>
</dd>
<dt class="field-odd">Version</dt>
<dd class="field-odd"><p>0.3.0</p>
</dd>
<dt class="field-even">History</dt>
<dd class="field-even"><p>Based on effective radiative recombination coefficients for C III lines from
Pequignot, Petitjean, Boisson, C. 1991A&amp;A…251..680P.</p>
<p>18/05/2013, A. Danehkar, Translated to IDL code.</p>
<p>06/04/2017, A. Danehkar, Integration with AtomNeb.</p>
<dl class="simple">
<dt>10/07/2019, A. Danehkar, Made a new function calc_emiss_c_iii_rl()</dt><dd><p>for calculating line emissivities and separated it
from calc_abund_c_iii_rl().</p>
</dd>
</dl>
<p>03/10/2020, A. Danehkar, Transferred from IDL to Python.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyequib.calc_emiss_h_beta">
<code class="sig-prename descclassname">pyequib.</code><code class="sig-name descname">calc_emiss_h_beta</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">temperature</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">density</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h_i_aeff_data</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyequib.html#calc_emiss_h_beta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyequib.calc_emiss_h_beta" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This function calculates the emissivity for H_beta 4861A
Emis(Hbeta)= 4pi j(HBeta 4861 A)/Np Ne) for the given temperature and density
by using the helium emissivities from
Storey &amp; Hummer, 1995MNRAS.272…41S.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Private</dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>type=double. This function returns the H beta emissivity 4pi j(HBeta 4861)/Np Ne).</p>
</dd>
<dt class="field-odd">Keywords</dt>
<dd class="field-odd"><dl class="simple">
<dt>temperature<span class="classifier">in, required, type=float</span></dt><dd><p>electron temperature</p>
</dd>
<dt>density<span class="classifier">in, required, type=float</span></dt><dd><p>electron density</p>
</dd>
<dt>h_i_aeff_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>H I recombination coefficients</p>
</dd>
</dl>
</dd>
<dt class="field-even">Categories</dt>
<dd class="field-even"><p>Abundance Analysis, Recombination Lines, Emissivity</p>
</dd>
<dt class="field-odd">Dirs</dt>
<dd class="field-odd"><dl class="simple">
<dt>./</dt><dd><p>Main routines</p>
</dd>
</dl>
</dd>
<dt class="field-even">Author</dt>
<dd class="field-even"><p>Ashkbiz Danehkar</p>
</dd>
<dt class="field-odd">Copyright</dt>
<dd class="field-odd"><p>This library is released under a GNU General Public License.</p>
</dd>
<dt class="field-even">Version</dt>
<dd class="field-even"><p>0.3.0</p>
</dd>
<dt class="field-odd">History</dt>
<dd class="field-odd"><p>Based on H I emissivities
from Storey &amp; Hummer, 1995MNRAS.272…41S.</p>
<p>25/08/2012, A. Danehkar, IDL code written.</p>
<p>11/03/2017, A. Danehkar, Integration with AtomNeb.</p>
<p>10/07/2019, A. Danehkar, Change from logarithmic to linear</p>
<p>03/10/2020, A. Danehkar, Transferred from IDL to Python.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyequib.calc_emiss_he_i_rl">
<code class="sig-prename descclassname">pyequib.</code><code class="sig-name descname">calc_emiss_he_i_rl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">temperature</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">density</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">linenum</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">he_i_aeff_data</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyequib.html#calc_emiss_he_i_rl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyequib.calc_emiss_he_i_rl" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This function calculates the emissivity
for the given wavelength of He I recombination line
by using the recombination coefficients from Porter et al.
2012MNRAS.425L..28P.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>type=double. This function returns the line emissivity.</p>
</dd>
<dt class="field-even">Keywords</dt>
<dd class="field-even"><dl>
<dt>temperature<span class="classifier">in, required, type=float</span></dt><dd><p>electron temperature</p>
</dd>
<dt>density<span class="classifier">in, required, type=float</span></dt><dd><p>electron density</p>
</dd>
<dt>linenum<span class="classifier">in, required, type=int</span></dt><dd><p>Line Number for Wavelength</p>
<p>Wavelength=4120.84:linenum=7,</p>
<p>Wavelength=4387.93: linenum=8,</p>
<p>Wavelength=4437.55: linenum=9,</p>
<p>Wavelength=4471.50: linenum=10,</p>
<p>Wavelength=4921.93: linenum=12,</p>
<p>Wavelength=5015.68: linenum=13,</p>
<p>Wavelength=5047.74: linenum=14,</p>
<p>Wavelength=5875.66: linenum=15,</p>
<p>Wavelength=6678.16: linenum=16,</p>
<p>Wavelength=7065.25: linenum=17,</p>
<p>Wavelength=7281.35: linenum=18.</p>
</dd>
<dt>line_flux<span class="classifier">in, required, type=float</span></dt><dd><p>line flux intensity</p>
</dd>
<dt>he_i_aeff_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>He I recombination coefficients</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Examples</dt>
<dd class="field-odd"><p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyequib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomneb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="s1">&#39;../externals/atomneb/&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_rc_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;atomic-data-rc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_rc_he_i_file</span><span class="o">=</span> <span class="n">filepath</span><span class="p">(</span><span class="s1">&#39;rc_he_ii_PFSD12.fits&#39;</span><span class="p">,</span> <span class="n">root_dir</span><span class="o">=</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">subdir</span><span class="o">=</span><span class="n">data_rc_dir</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_rc_sh95_file</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_rc_dir</span><span class="p">,</span> <span class="s1">&#39;rc_SH95.fits&#39;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;he&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ion</span><span class="o">=</span><span class="s1">&#39;ii&#39;</span> <span class="c1"># He I</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">he_i_rc_data</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_aeff_he_i_pfsd12</span><span class="p">(</span><span class="n">atom_rc_he_i_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">he_i_aeff_data</span><span class="o">=</span><span class="n">he_i_rc_data</span><span class="p">[</span><span class="s1">&#39;aeff&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">temperature</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">10000.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">density</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">5000.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">linenum</span><span class="o">=</span><span class="mi">10</span><span class="c1"># 4471.50</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">emiss_he_i</span><span class="o">=</span><span class="n">pyequib</span><span class="o">.</span><span class="n">calc_emiss_he_i_rl</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="n">density</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                               <span class="n">linenum</span><span class="o">=</span><span class="n">linenum</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                               <span class="n">he_i_aeff_data</span><span class="o">=</span><span class="n">he_i_aeff_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Emissivity:&#39;</span><span class="p">,</span> <span class="n">emiss_he_i</span><span class="p">)</span>
<span class="go">   Emissivity:   6.3822830e-26</span>
</pre></div>
</div>
</dd>
<dt class="field-even">Categories</dt>
<dd class="field-even"><p>Abundance Analysis, Recombination Lines, Emissivity</p>
</dd>
<dt class="field-odd">Dirs</dt>
<dd class="field-odd"><dl class="simple">
<dt>./</dt><dd><p>Main routines</p>
</dd>
</dl>
</dd>
<dt class="field-even">Author</dt>
<dd class="field-even"><p>Ashkbiz Danehkar</p>
</dd>
<dt class="field-odd">Copyright</dt>
<dd class="field-odd"><p>This library is released under a GNU General Public License.</p>
</dd>
<dt class="field-even">Version</dt>
<dd class="field-even"><p>0.3.0</p>
</dd>
<dt class="field-odd">History</dt>
<dd class="field-odd"><p>Based on improved He I emissivities in the case B
from Porter et al. 2012MNRAS.425L..28P</p>
<p>15/12/2013, A. Danehkar, IDL code written.</p>
<p>20/03/2017, A. Danehkar, Integration with AtomNeb.</p>
<dl class="simple">
<dt>10/07/2019, A. Danehkar, Made a new function calc_emiss_he_i_rl()</dt><dd><p>for calculating line emissivities and separated it
from calc_abund_he_i_rl().</p>
</dd>
</dl>
<p>03/10/2020, A. Danehkar, Transferred from IDL to Python.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyequib.calc_emiss_he_ii_rl">
<code class="sig-prename descclassname">pyequib.</code><code class="sig-name descname">calc_emiss_he_ii_rl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">temperature</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">density</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">he_ii_aeff_data</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyequib.html#calc_emiss_he_ii_rl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyequib.calc_emiss_he_ii_rl" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This functioncalculates the emissivity
for the He II recombination line 4686 A
by using the helium emissivities from
Storey &amp; Hummer, 1995MNRAS.272…41S.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>type=double. This function returns the line emissivity.</p>
</dd>
<dt class="field-even">Keywords</dt>
<dd class="field-even"><dl class="simple">
<dt>temperature<span class="classifier">in, required, type=float</span></dt><dd><p>electron temperature</p>
</dd>
<dt>density<span class="classifier">in, required, type=float</span></dt><dd><p>electron density</p>
</dd>
<dt>he_ii_aeff_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>He II recombination coefficients</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Examples</dt>
<dd class="field-odd"><p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyequib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomneb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="s1">&#39;../externals/atomneb/&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_rc_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;atomic-data-rc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_rc_he_i_file</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_rc_dir</span><span class="p">,</span> <span class="s1">&#39;rc_he_ii_PFSD12.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_rc_sh95_file</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_rc_dir</span><span class="p">,</span> <span class="s1">&#39;rc_SH95.fits&#39;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;he&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ion</span><span class="o">=</span><span class="s1">&#39;iii&#39;</span> <span class="c1"># He II</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">he_ii_rc_data</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_aeff_sh95</span><span class="p">(</span><span class="n">atom_rc_sh95_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">he_ii_aeff_data</span><span class="o">=</span><span class="n">he_ii_rc_data</span><span class="p">[</span><span class="s1">&#39;aeff&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">temperature</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">10000.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">density</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">5000.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">he_ii_4686_flux</span> <span class="o">=</span> <span class="mf">135.833</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">emiss_he_ii</span><span class="o">=</span><span class="n">pyequib</span><span class="o">.</span><span class="n">calc_emiss_he_ii_rl</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="n">density</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                <span class="n">he_ii_aeff_data</span><span class="o">=</span><span class="n">he_ii_aeff_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Emissivity:&#39;</span><span class="p">,</span> <span class="n">emiss_he_ii</span><span class="p">)</span>
<span class="go">   Emissivity:   1.4989134e-24</span>
</pre></div>
</div>
</dd>
<dt class="field-even">Categories</dt>
<dd class="field-even"><p>Abundance Analysis, Recombination Lines, Emissivity</p>
</dd>
<dt class="field-odd">Dirs</dt>
<dd class="field-odd"><dl class="simple">
<dt>./</dt><dd><p>Main routines</p>
</dd>
</dl>
</dd>
<dt class="field-even">Author</dt>
<dd class="field-even"><p>Ashkbiz Danehkar</p>
</dd>
<dt class="field-odd">Copyright</dt>
<dd class="field-odd"><p>This library is released under a GNU General Public License.</p>
</dd>
<dt class="field-even">Version</dt>
<dd class="field-even"><p>0.3.0</p>
</dd>
<dt class="field-odd">History</dt>
<dd class="field-odd"><p>Based on He II emissivities
from Storey &amp; Hummer, 1995MNRAS.272…41S.</p>
<p>15/12/2013, A. Danehkar, IDL code written.</p>
<p>02/04/2017, A. Danehkar, Integration with AtomNeb.</p>
<p>10/07/2019, A. Danehkar, Change from logarithmic to linear</p>
<dl class="simple">
<dt>10/07/2019, A. Danehkar, Made a new function calc_emiss_he_ii_rl()</dt><dd><p>for calculating line emissivities and separated it
from calc_abund_he_ii_rl().</p>
</dd>
</dl>
<p>03/10/2020, A. Danehkar, Transferred from IDL to Python.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyequib.calc_emiss_n_ii_rl">
<code class="sig-prename descclassname">pyequib.</code><code class="sig-name descname">calc_emiss_n_ii_rl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">temperature</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">density</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wavelength</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">n_ii_rc_br</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">n_ii_rc_data</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyequib.html#calc_emiss_n_ii_rl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyequib.calc_emiss_n_ii_rl" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This function calculates the emissivity
for the given wavelength of N II recombination line
by using the recombination coefficients from
Escalante &amp; Victor 1990ApJS…73..513E.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>type=double. This function returns the line emissivity.</p>
</dd>
<dt class="field-even">Keywords</dt>
<dd class="field-even"><dl class="simple">
<dt>temperature<span class="classifier">in, required, type=float</span></dt><dd><p>electron temperature</p>
</dd>
<dt>density<span class="classifier">in, required, type=float</span></dt><dd><p>electron density</p>
</dd>
<dt>wavelength<span class="classifier">in, required, type=float</span></dt><dd><p>Line Wavelength in Angstrom</p>
</dd>
<dt>n_ii_rc_br<span class="classifier">in, required, type=array/object</span></dt><dd><p>N II branching ratios (Br)</p>
</dd>
<dt>n_ii_rc_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>N II recombination coefficients</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Examples</dt>
<dd class="field-odd"><p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyequib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomneb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="s1">&#39;../externals/atomneb/&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_rc_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;atomic-data-rc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_rc_all_file</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_rc_dir</span><span class="p">,</span> <span class="s1">&#39;rc_collection.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_rc_sh95_file</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_rc_dir</span><span class="p">,</span> <span class="s1">&#39;rc_SH95.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;h&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ion</span><span class="o">=</span><span class="s1">&#39;ii&#39;</span> <span class="c1"># H I</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h_i_rc_data</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_aeff_sh95</span><span class="p">(</span><span class="n">atom_rc_sh95_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h_i_aeff_data</span><span class="o">=</span><span class="n">h_i_rc_data</span><span class="p">[</span><span class="s1">&#39;aeff&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ion</span><span class="o">=</span><span class="s1">&#39;iii&#39;</span> <span class="c1"># N II</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_ii_rc_data</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_aeff_collection</span><span class="p">(</span><span class="n">atom_rc_all_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_ii_rc_data_br</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_aeff_collection</span><span class="p">(</span><span class="n">atom_rc_all_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">,</span> <span class="n">br</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">temperature</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">10000.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">density</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">5000.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelength</span><span class="o">=</span><span class="mf">4442.02</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">emiss_n_ii</span><span class="o">=</span><span class="n">pyequib</span><span class="o">.</span><span class="n">calc_emiss_n_ii_rl</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="n">density</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">wavelength</span><span class="o">=</span><span class="n">wavelength</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">n_ii_rc_br</span><span class="o">=</span><span class="n">n_ii_rc_data_br</span><span class="p">,</span> <span class="n">n_ii_rc_data</span><span class="o">=</span><span class="n">n_ii_rc_data</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">h_i_aeff_data</span><span class="o">=</span><span class="n">h_i_aeff_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Emissivity:&#39;</span><span class="p">,</span> <span class="n">emiss_n_ii</span><span class="p">)</span>
<span class="go">   Emissivity:   3.0397397e-26</span>
</pre></div>
</div>
</dd>
<dt class="field-even">Categories</dt>
<dd class="field-even"><p>Abundance Analysis, Recombination Lines, Emissivity</p>
</dd>
<dt class="field-odd">Dirs</dt>
<dd class="field-odd"><dl class="simple">
<dt>./</dt><dd><p>Main routines</p>
</dd>
</dl>
</dd>
<dt class="field-even">Author</dt>
<dd class="field-even"><p>Ashkbiz Danehkar</p>
</dd>
<dt class="field-odd">Copyright</dt>
<dd class="field-odd"><p>This library is released under a GNU General Public License.</p>
</dd>
<dt class="field-even">Version</dt>
<dd class="field-even"><p>0.3.0</p>
</dd>
<dt class="field-odd">History</dt>
<dd class="field-odd"><p>Based on Effective recombination coefficients for N II lines from
Escalante &amp; Victor 1990ApJS…73..513E.</p>
<p>Adopted from MIDAS Rnii script written by X.W.Liu.</p>
<dl class="simple">
<dt>Revised based on scripts by Yong Zhang added to MOCASSIN, 02/2003</dt><dd><p>Ercolano et al. 2005MNRAS.362.1038E.</p>
</dd>
</dl>
<p>10/05/2013, A. Danehkar, Translated to IDL code.</p>
<p>25/04/2017, A. Danehkar, Integration with AtomNeb.</p>
<dl class="simple">
<dt>10/07/2019, A. Danehkar, Made a new function calc_emiss_n_ii_rl()</dt><dd><p>for calculating line emissivities and separated it
from calc_abund_n_ii_rl().</p>
</dd>
</dl>
<p>03/10/2020, A. Danehkar, Transferred from IDL to Python.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyequib.calc_emiss_n_iii_rl">
<code class="sig-prename descclassname">pyequib.</code><code class="sig-name descname">calc_emiss_n_iii_rl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">temperature</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">density</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wavelength</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">n_iii_rc_data</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyequib.html#calc_emiss_n_iii_rl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyequib.calc_emiss_n_iii_rl" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><blockquote>
<div><p>This function calculates the emissivity
for the given wavelength of N III recombination line
by using the recombination coefficients from
Pequignot et al. 1991A&amp;A…251..680P.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>type=double. This function returns the line emissivity.</p>
</dd>
<dt class="field-even">Keywords</dt>
<dd class="field-even"><dl class="simple">
<dt>temperature<span class="classifier">in, required, type=float</span></dt><dd><p>electron temperature</p>
</dd>
<dt>density<span class="classifier">in, required, type=float</span></dt><dd><p>electron density</p>
</dd>
<dt>wavelength<span class="classifier">in, required, type=float</span></dt><dd><p>Line Wavelength in Angstrom</p>
</dd>
<dt>n_iii_rc_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>N III recombination coefficients</p>
</dd>
</dl>
</dd>
</dl>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Examples</dt>
<dd class="field-odd"><blockquote>
<div><p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyequib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomneb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="s1">&#39;../externals/atomneb/&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_rc_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;atomic-data-rc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_rc_ppb91_file</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_rc_dir</span><span class="p">,</span> <span class="s1">&#39;rc_PPB91.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_rc_sh95_file</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_rc_dir</span><span class="p">,</span> <span class="s1">&#39;rc_SH95.fits&#39;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ion</span><span class="o">=</span><span class="s1">&#39;iv&#39;</span> <span class="c1"># N III</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_iii_rc_data</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_aeff_ppb91</span><span class="p">(</span><span class="n">atom_rc_ppb91_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">temperature</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">10000.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">density</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">5000.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelength</span><span class="o">=</span><span class="mf">4640.64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">emiss_n_iii</span><span class="o">=</span><span class="n">pyequib</span><span class="o">.</span><span class="n">calc_abund_n_iii_rl</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="n">density</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                <span class="n">wavelength</span><span class="o">=</span><span class="n">wavelength</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                <span class="n">n_iii_rc_data</span><span class="o">=</span><span class="n">n_iii_rc_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Emissivity:&#39;</span><span class="p">,</span> <span class="n">emiss_n_iii</span><span class="p">)</span>
<span class="go">   Emissivity:   4.7908644e-24</span>
</pre></div>
</div>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Categories</dt>
<dd class="field-odd"><p>Abundance Analysis, Recombination Lines, Emissivity</p>
</dd>
<dt class="field-even">Dirs</dt>
<dd class="field-even"><dl class="simple">
<dt>./</dt><dd><p>Main routines</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Author</dt>
<dd class="field-odd"><p>Ashkbiz Danehkar</p>
</dd>
<dt class="field-even">Copyright</dt>
<dd class="field-even"><p>This library is released under a GNU General Public License.</p>
</dd>
<dt class="field-odd">Version</dt>
<dd class="field-odd"><p>0.3.0</p>
</dd>
<dt class="field-even">History</dt>
<dd class="field-even"><p>Based on  effective radiative recombination coefficients for N III lines from
Pequignot, Petitjean, Boisson, C. 1991A&amp;A…251..680P.</p>
<p>10/05/2013, A. Danehkar, IDL code written.</p>
<p>20/04/2017, A. Danehkar, Integration with AtomNeb.</p>
<dl class="simple">
<dt>10/07/2019, A. Danehkar, Made a new function calc_emiss_n_iii_rl()</dt><dd><p>for calculating line emissivities and separated it
from calc_abund_n_iii_rl().</p>
</dd>
</dl>
<p>03/10/2020, A. Danehkar, Transferred from IDL to Python.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyequib.calc_emiss_ne_ii_rl">
<code class="sig-prename descclassname">pyequib.</code><code class="sig-name descname">calc_emiss_ne_ii_rl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">temperature</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">density</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wavelength</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ne_ii_rc_data</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyequib.html#calc_emiss_ne_ii_rl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyequib.calc_emiss_ne_ii_rl" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><blockquote>
<div><p>This function calculates the emissivity
for the given wavelength of Ne II recombination line
by using the recombination coefficients from
Kisielius et al. (1998) &amp; Storey (unpublished).</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>type=double. This function returns the line emissivity.</p>
</dd>
<dt class="field-even">Keywords</dt>
<dd class="field-even"><dl class="simple">
<dt>temperature<span class="classifier">in, required, type=float</span></dt><dd><p>electron temperature</p>
</dd>
<dt>density<span class="classifier">in, required, type=float</span></dt><dd><p>electron density</p>
</dd>
<dt>wavelength<span class="classifier">in, required, type=float</span></dt><dd><p>Line Wavelength in Angstrom</p>
</dd>
<dt>ne_ii_rc_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>Ne II recombination coefficients</p>
</dd>
</dl>
</dd>
</dl>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Examples</dt>
<dd class="field-odd"><blockquote>
<div><p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyequib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomneb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="s1">&#39;../externals/atomneb/&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_rc_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;atomic-data-rc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_rc_all_file</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_rc_dir</span><span class="p">,</span> <span class="s1">&#39;rc_collection.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_rc_sh95_file</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_rc_dir</span><span class="p">,</span> <span class="s1">&#39;rc_SH95.fits&#39;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;ne&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ion</span><span class="o">=</span><span class="s1">&#39;iii&#39;</span> <span class="c1"># Ne II</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ne_ii_rc_data</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_aeff_collection</span><span class="p">(</span><span class="n">atom_rc_all_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">temperature</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">10000.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">density</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">5000.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelength</span><span class="o">=</span><span class="mf">3777.14</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">emiss_ne_ii</span><span class="o">=</span><span class="n">pyequib</span><span class="o">.</span><span class="n">calc_emiss_ne_ii_rl</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="n">density</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                <span class="n">wavelength</span><span class="o">=</span><span class="n">wavelength</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                <span class="n">ne_ii_rc_data</span><span class="o">=</span><span class="n">ne_ii_rc_data</span><span class="p">,</span> <span class="n">h_i_aeff_data</span><span class="o">=</span><span class="n">h_i_aeff_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Emissivity:&#39;</span><span class="p">,</span> <span class="n">emiss_ne_ii</span><span class="p">)</span>
<span class="go">   Emissivity:   1.5996881e-25</span>
</pre></div>
</div>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Categories</dt>
<dd class="field-odd"><p>Abundance Analysis, Recombination Lines, Emissivity</p>
</dd>
<dt class="field-even">Dirs</dt>
<dd class="field-even"><dl class="simple">
<dt>./</dt><dd><p>Main routines</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Author</dt>
<dd class="field-odd"><p>Ashkbiz Danehkar</p>
</dd>
<dt class="field-even">Copyright</dt>
<dd class="field-even"><p>This library is released under a GNU General Public License.</p>
</dd>
<dt class="field-odd">Version</dt>
<dd class="field-odd"><p>0.3.0</p>
</dd>
<dt class="field-even">History</dt>
<dd class="field-even"><p>Based on effective radiative recombination coefficients for Ne II lines
from Kisielius et al. 1998A&amp;AS..133..257K &amp; Storey (unpublished).</p>
<p>Adopted from MOCASSIN, Ercolano et al. 2005MNRAS.362.1038E.</p>
<p>02/2003, Yong Zhang, scripts added to MOCASSIN.</p>
<p>14/05/2013, A. Danehkar, Translated to IDL code.</p>
<p>10/04/2017, A. Danehkar, Integration with AtomNeb.</p>
<dl class="simple">
<dt>10/07/2019, A. Danehkar, Made a new function calc_emiss_ne_ii_rl()</dt><dd><p>for calculating line emissivities and separated it
from calc_abund_ne_ii_rl().</p>
</dd>
</dl>
<p>03/10/2020, A. Danehkar, Transferred from IDL to Python.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyequib.calc_emiss_o_ii_rl">
<code class="sig-prename descclassname">pyequib.</code><code class="sig-name descname">calc_emiss_o_ii_rl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">temperature</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">density</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wavelength</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">o_ii_rc_br</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">o_ii_rc_data</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyequib.html#calc_emiss_o_ii_rl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyequib.calc_emiss_o_ii_rl" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This function calculates the emissivity
for the given wavelength of O II recombination line
by using the recombination coefficients from
Storey 1994A&amp;A…282..999S and Liu et al. 1995MNRAS.272..369L.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>type=double. This function returns the line emissivity.</p>
</dd>
<dt class="field-even">Keywords</dt>
<dd class="field-even"><dl class="simple">
<dt>temperature<span class="classifier">in, required, type=float</span></dt><dd><p>electron temperature</p>
</dd>
<dt>density<span class="classifier">in, required, type=float</span></dt><dd><p>electron density</p>
</dd>
<dt>wavelength<span class="classifier">in, required, type=float</span></dt><dd><p>Line Wavelength in Angstrom</p>
</dd>
<dt>o_ii_rc_br<span class="classifier">in, required, type=array/object</span></dt><dd><p>O II branching ratios (Br)</p>
</dd>
<dt>o_ii_rc_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>O II recombination coefficients</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Examples</dt>
<dd class="field-odd"><p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyequib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomneb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="s1">&#39;../externals/atomneb/&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_rc_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;atomic-data-rc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_rc_all_file</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_rc_dir</span><span class="p">,</span> <span class="s1">&#39;rc_collection.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_rc_sh95_file</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_rc_dir</span><span class="p">,</span> <span class="s1">&#39;rc_SH95.fits&#39;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;o&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ion</span><span class="o">=</span><span class="s1">&#39;iii&#39;</span> <span class="c1"># O II</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o_ii_rc_data</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_aeff_collection</span><span class="p">(</span><span class="n">atom_rc_all_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o_ii_rc_data_br</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_aeff_collection</span><span class="p">(</span><span class="n">atom_rc_all_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">,</span> <span class="n">br</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">temperature</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">10000.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">density</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">5000.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelength</span><span class="o">=</span><span class="mf">4613.68</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">emiss_o_ii</span><span class="o">=</span><span class="n">pyequib</span><span class="o">.</span><span class="n">calc_emiss_o_ii_rl</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="n">density</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">wavelength</span><span class="o">=</span><span class="n">wavelength</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">o_ii_rc_br</span><span class="o">=</span><span class="n">o_ii_rc_data_br</span><span class="p">,</span> <span class="n">o_ii_rc_data</span><span class="o">=</span><span class="n">o_ii_rc_data</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">h_i_aeff_data</span><span class="o">=</span><span class="n">h_i_aeff_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Emissivity:&#39;</span><span class="p">,</span> <span class="n">emiss_o_ii</span><span class="p">)</span>
<span class="go">   Emissivity:   5.9047319e-27</span>
</pre></div>
</div>
</dd>
<dt class="field-even">Categories</dt>
<dd class="field-even"><p>Abundance Analysis, Recombination Lines, Emissivity</p>
</dd>
<dt class="field-odd">Dirs</dt>
<dd class="field-odd"><dl class="simple">
<dt>./</dt><dd><p>Main routines</p>
</dd>
</dl>
</dd>
<dt class="field-even">Author</dt>
<dd class="field-even"><p>Ashkbiz Danehkar</p>
</dd>
<dt class="field-odd">Copyright</dt>
<dd class="field-odd"><p>This library is released under a GNU General Public License.</p>
</dd>
<dt class="field-even">Version</dt>
<dd class="field-even"><p>0.3.0</p>
</dd>
<dt class="field-odd">History</dt>
<dd class="field-odd"><p>Based on recombination coefficients for O II lines from
Storey 1994A&amp;A…282..999S and Liu et al. 1995MNRAS.272..369L.</p>
<p>Adopted from MIDAS script Roii.prg written by X.W.Liu.</p>
<dl class="simple">
<dt>Revised based on scripts by Yong Zhang added to MOCASSIN, 02/2003</dt><dd><p>Ercolano et al. 2005MNRAS.362.1038E.</p>
</dd>
</dl>
<p>10/05/2013, A. Danehkar, Translated to IDL code.</p>
<p>25/04/2017, A. Danehkar, Integration with AtomNeb.</p>
<dl class="simple">
<dt>10/07/2019, A. Danehkar, Made a new function calc_emiss_o_ii_rl()</dt><dd><p>for calculating line emissivities and separated it
from calc_abund_o_ii_rl().</p>
</dd>
</dl>
<p>03/10/2020, A. Danehkar, Transferred from IDL to Python.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyequib.calc_emissivity">
<code class="sig-prename descclassname">pyequib.</code><code class="sig-name descname">calc_emissivity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">temperature</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">density</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">atomic_levels</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">elj_data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">omij_data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">aij_data</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyequib.html#calc_emissivity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyequib.calc_emissivity" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This function calculates line emissivities for specified ion with level(s) by
solving atomic level populations and in statistical equilibrium
for given electron density and temperature.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>type=double. This function returns the line emissivity.</p>
</dd>
<dt class="field-even">Keywords</dt>
<dd class="field-even"><dl class="simple">
<dt>temperature<span class="classifier">in, required, type=float</span></dt><dd><p>electron temperature</p>
</dd>
<dt>density<span class="classifier">in, required, type=float</span></dt><dd><p>electron density</p>
</dd>
<dt>atomic_levels<span class="classifier">In, required, type=string</span></dt><dd><p>level(s) e.g ‘1,2/’, ‘1,2,1,3/’</p>
</dd>
<dt>elj_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>energy levels (Ej) data</p>
</dd>
<dt>omij_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>collision strengths (omega_ij) data</p>
</dd>
<dt>aij_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>transition probabilities (Aij) data</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Examples</dt>
<dd class="field-odd"><p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyequib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomneb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="s1">&#39;../externals/atomneb/&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;atomic-data&#39;</span><span class="p">,</span> <span class="s1">&#39;chianti70&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_elj_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;AtomElj.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_omij_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;AtomOmij.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_aij_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;AtomAij.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;o&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ion</span><span class="o">=</span><span class="s1">&#39;iii&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o_iii_elj</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_elj</span><span class="p">(</span><span class="n">atom_elj_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">,</span> <span class="n">level_num</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># read Energy Levels (Ej)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o_iii_omij</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_omij</span><span class="p">(</span><span class="n">atom_omij_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span> <span class="c1"># read Collision Strengths (Omegaij)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o_iii_aij</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_aij</span><span class="p">(</span><span class="n">atom_aij_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span> <span class="c1"># read Transition Probabilities (Aij)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">temperature</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">10000.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">density</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">5000.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atomic_levels</span><span class="o">=</span><span class="s1">&#39;3,4/&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">emiss5007</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">emiss5007</span><span class="o">=</span><span class="n">pyequib</span><span class="o">.</span><span class="n">calc_emissivity</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="n">density</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                          <span class="n">atomic_levels</span><span class="o">=</span><span class="n">atomic_levels</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                          <span class="n">elj_data</span><span class="o">=</span><span class="n">o_iii_elj</span><span class="p">,</span> <span class="n">omij_data</span><span class="o">=</span><span class="n">o_iii_omij</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                          <span class="n">aij_data</span><span class="o">=</span><span class="n">o_iii_aij</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Emissivity(O III 5007):&#39;</span><span class="p">,</span> <span class="n">emiss5007</span><span class="p">)</span>
<span class="go">   Emissivity(O III 5007):   3.6041012e-21</span>
</pre></div>
</div>
</dd>
<dt class="field-even">Categories</dt>
<dd class="field-even"><p>Abundance Analysis, Collisionally Excited Lines, Emissivity</p>
</dd>
<dt class="field-odd">Dirs</dt>
<dd class="field-odd"><dl class="simple">
<dt>./</dt><dd><p>Main routines</p>
</dd>
</dl>
</dd>
<dt class="field-even">Author</dt>
<dd class="field-even"><p>Ashkbiz Danehkar</p>
</dd>
<dt class="field-odd">Copyright</dt>
<dd class="field-odd"><p>This library is released under a GNU General Public License.</p>
</dd>
<dt class="field-even">Version</dt>
<dd class="field-even"><p>0.3.0</p>
</dd>
<dt class="field-odd">History</dt>
<dd class="field-odd"><p>15/09/2013, A. Danehkar, Translated from FORTRAN to IDL code.</p>
<p>20/10/2016, A. Danehkar, Replaced str2int with strnumber.</p>
<dl class="simple">
<dt>20/10/2016, A. Danehkar, Replaced CFY, SPLMAT, and CFD with</dt><dd><p>IDL function INTERPOL( /SPLINE).</p>
</dd>
<dt>20/10/2016, A. Danehkar, Replaced LUSLV with IDL LAPACK function</dt><dd><p>LA_LINEAR_EQUATION.</p>
</dd>
<dt>15/11/2016, A. Danehkar, Replaced LA_LINEAR_EQUATION (not work in GDL)</dt><dd><p>with IDL function LUDC &amp; LUSOL.</p>
</dd>
<dt>19/11/2016, A. Danehkar, Replaced INTERPOL (not accurate) with</dt><dd><p>SPL_INIT &amp; SPL_INTERP.</p>
</dd>
<dt>20/11/2016, A. Danehkar, Made a new function calc_populations()</dt><dd><p>for solving atomic level populations and separated it from
calc_abundance(), calc_density() and calc_temperature().</p>
</dd>
<dt>21/11/2016, A. Danehkar, Made a new function calc_emissivity()</dt><dd><p>for calculating line emissivities and separated it
from calc_abundance().</p>
</dd>
<dt>10/03/2017, A. Danehkar, Integration with AtomNeb, now uses atomic data</dt><dd><p>input elj_data, omij_data, aij_data.</p>
</dd>
<dt>12/06/2017, A. Danehkar, Cleaning the function, and remove unused varibales</dt><dd><p>from calc_emissivity().</p>
</dd>
</dl>
<p>27/06/2019, A. Danehkar, Use the simplified calc_populations() routine.</p>
<p>03/10/2020, A. Danehkar, Transferred from IDL to Python.</p>
</dd>
</dl>
<p>FORTRAN HISTORY:</p>
<blockquote>
<div><p>03/05/1981, I.D.Howarth,  Version 1.</p>
<p>05/05/1981, I.D.Howarth,  Minibug fixed!</p>
<p>07/05/1981, I.D.Howarth,  Now takes collision rates or strengths.</p>
<p>03/08/1981, S.Adams,      Interpolates collision strengths.</p>
<p>07/08/1981, S.Adams,      Input method changed.</p>
<dl class="simple">
<dt>19/11/1984, R.E.S.Clegg,  SA files entombed in scratch disk. Logical</dt><dd><p>filenames given to SA’s data files.</p>
</dd>
</dl>
<p>08/1995, D.P.Ruffle, Changed input file format. Increased matrices.</p>
<dl class="simple">
<dt>02/1996, X.W.Liu,   Tidy up. SUBROUTINES SPLMAT, HGEN, CFY and CFD</dt><dd><p>modified such that matrix sizes (i.e. maximum
of Te and maximum no of levels) can now be cha
by modifying the parameters NDIM1, NDIM2 and N
in the Main program. EASY!
Now takes collision rates as well.
All variables are declared explicitly
Generate two extra files (ionpop.lis and ionra
of plain stream format for plotting.</p>
</dd>
<dt>06/1996, C.J.Pritchet, Changed input data format for cases IBIG=1,2.</dt><dd><p>Fixed readin bug for IBIG=2 case.
Now reads reformatted upsilons (easier to see
and the 0 0 0 data end is excluded for these c
The A values have a different format for IBIG=.</p>
</dd>
</dl>
<p>2006, B.Ercolano,   Converted to F90.</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt id="pyequib.calc_populations">
<code class="sig-prename descclassname">pyequib.</code><code class="sig-name descname">calc_populations</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">temperature</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">density</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">elj_data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">omij_data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">aij_data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">eff_omij</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">level_num</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">irats</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyequib.html#calc_populations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyequib.calc_populations" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This function solves atomic level populations in statistical equilibrium
for given electron temperature and density.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>type=array/object. This function returns the atomic level populations.</p>
</dd>
<dt class="field-even">Keywords</dt>
<dd class="field-even"><dl class="simple">
<dt>temperature<span class="classifier">in, required, type=float</span></dt><dd><p>electron temperature</p>
</dd>
<dt>density<span class="classifier">in, required, type=float</span></dt><dd><p>electron density</p>
</dd>
<dt>elj_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>energy levels (Ej) data</p>
</dd>
<dt>omij_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>collision strengths (omega_ij) data</p>
</dd>
<dt>aij_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>transition probabilities (Aij) data</p>
</dd>
<dt>eff_Omij<span class="classifier">in, type=array/object</span></dt><dd><p>effective collision strengths (Omij_T) at given temperature</p>
</dd>
<dt>level_num<span class="classifier">in, type=int</span></dt><dd><p>Number of levels</p>
</dd>
<dt>irats<span class="classifier">in, type=int</span></dt><dd><p>Else Coll. rates = tabulated values * 10 ** irats</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Examples</dt>
<dd class="field-odd"><p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyequib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomneb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="s1">&#39;../externals/atomneb/&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;atomic-data&#39;</span><span class="p">,</span> <span class="s1">&#39;chianti70&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_elj_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;AtomElj.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_omij_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;AtomOmij.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_aij_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;AtomAij.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;s&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ion</span><span class="o">=</span><span class="s1">&#39;ii&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_ii_elj</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_elj</span><span class="p">(</span><span class="n">atom_elj_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">,</span> <span class="n">level_num</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># read Energy Levels (Ej)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_ii_omij</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_omij</span><span class="p">(</span><span class="n">atom_omij_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span> <span class="c1"># read Collision Strengths (Omegaij)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_ii_aij</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_aij</span><span class="p">(</span><span class="n">atom_aij_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span> <span class="c1"># read Transition Probabilities (Aij)        &gt;&gt;&gt; density = np.float64(1000)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">temperature</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">10000.0</span><span class="p">)</span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nlj</span><span class="o">=</span><span class="n">pyequib</span><span class="o">.</span><span class="n">calc_populations</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="n">density</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                     <span class="n">elj_data</span><span class="o">=</span><span class="n">s_ii_elj</span><span class="p">,</span> <span class="n">omij_data</span><span class="o">=</span><span class="n">s_ii_omij</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                     <span class="n">aij_data</span><span class="o">=</span><span class="n">s_ii_aij</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Atomic Level Populations:&#39;</span><span class="p">,</span> <span class="n">nlj</span><span class="p">)</span>
<span class="go">   Atomic Level Populations:    0.96992832    0.0070036315     0.023062261   2.6593671e-06   3.1277019e-06</span>
</pre></div>
</div>
</dd>
<dt class="field-even">Categories</dt>
<dd class="field-even"><p>Plasma Diagnostics, Abundance Analysis, Collisionally Excited Lines</p>
</dd>
<dt class="field-odd">Dirs</dt>
<dd class="field-odd"><dl class="simple">
<dt>./</dt><dd><p>Subroutines</p>
</dd>
</dl>
</dd>
<dt class="field-even">Author</dt>
<dd class="field-even"><p>Ashkbiz Danehkar</p>
</dd>
<dt class="field-odd">Copyright</dt>
<dd class="field-odd"><p>This library is released under a GNU General Public License.</p>
</dd>
<dt class="field-even">Version</dt>
<dd class="field-even"><p>0.3.0</p>
</dd>
<dt class="field-odd">History</dt>
<dd class="field-odd"><p>15/09/2013, A. Danehkar, Translated from FORTRAN to IDL code.</p>
<p>20/10/2016, A. Danehkar, Replaced str2int with strnumber.</p>
<dl class="simple">
<dt>20/10/2016, A. Danehkar, Replaced CFY, SPLMAT, and CFD with</dt><dd><p>IDL function INTERPOL( /SPLINE).</p>
</dd>
<dt>20/10/2016, A. Danehkar, Replaced LUSLV with IDL LAPACK function</dt><dd><p>LA_LINEAR_EQUATION.</p>
</dd>
<dt>15/11/2016, A. Danehkar, Replaced LA_LINEAR_EQUATION (not work in GDL)</dt><dd><p>with IDL function LUDC &amp; LUSOL.</p>
</dd>
<dt>19/11/2016, A. Danehkar, Replaced INTERPOL (not accurate) with</dt><dd><p>SPL_INIT &amp; SPL_INTERP.</p>
</dd>
<dt>20/11/2016, A. Danehkar, Made a new function calc_populations()</dt><dd><p>for solving atomic level populations and separated it from
calc_abundance(), calc_density() and calc_temperature().</p>
</dd>
<dt>10/03/2017, A. Danehkar, Integration with AtomNeb, now uses atomic data</dt><dd><p>input elj_data, omij_data, aij_data.</p>
</dd>
<dt>12/06/2017, A. Danehkar, Cleaning the function, and remove unused varibales</dt><dd><p>from calc_populations().</p>
</dd>
<dt>27/02/2019, A. Danehkar, Simplify the calc_populations() routine</dt><dd><p>for external usage.</p>
</dd>
</dl>
<p>04/03/2019, A. Danehkar, Use the get_omij_temp() routine.</p>
<p>03/10/2020, A. Danehkar, Transferred from IDL to Python.</p>
</dd>
</dl>
<p>FORTRAN HISTORY:</p>
<blockquote>
<div><p>03/05/1981, I.D.Howarth,  Version 1.</p>
<p>05/05/1981, I.D.Howarth,  Minibug fixed!</p>
<p>07/05/1981, I.D.Howarth,  Now takes collision rates or strengths.</p>
<p>03/08/1981, S.Adams,      Interpolates collision strengths.</p>
<p>07/08/1981, S.Adams,      Input method changed.</p>
<dl class="simple">
<dt>19/11/1984, R.E.S.Clegg,  SA files entombed in scratch disk. Logical</dt><dd><p>filenames given to SA’s data files.</p>
</dd>
</dl>
<p>08/1995, D.P.Ruffle, Changed input file format. Increased matrices.</p>
<dl class="simple">
<dt>02/1996, X.W.Liu,   Tidy up. SUBROUTINES SPLMAT, HGEN, CFY and CFD</dt><dd><p>modified such that matrix sizes (i.e. maximum
of Te and maximum no of levels) can now be cha
by modifying the parameters NDIM1, NDIM2 and N
in the Main program. EASY!
Now takes collision rates as well.
All variables are declared explicitly
Generate two extra files (ionpop.lis and ionra
of plain stream format for plotting.</p>
</dd>
<dt>06/1996, C.J.Pritchet, Changed input data format for cases IBIG=1,2.</dt><dd><p>Fixed readin bug for IBIG=2 case.
Now reads reformatted upsilons (easier to see
and the 0 0 0 data end is excluded for these c
The A values have a different format for IBIG=.</p>
</dd>
</dl>
<p>2006, B.Ercolano,   Converted to F90.</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt id="pyequib.calc_temperature">
<code class="sig-prename descclassname">pyequib.</code><code class="sig-name descname">calc_temperature</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">line_flux_ratio</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">density</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">upper_levels</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lower_levels</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">elj_data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">omij_data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">aij_data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">low_temperature</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">high_temperature</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">num_temperature</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">min_density</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyequib.html#calc_temperature"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyequib.calc_temperature" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This function determines electron temperature from given
flux intensity ratio for specified ion with upper level(s)
lower level(s) by solving atomic level populations and
line emissivities in statistical equilibrium
for given electron density.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>type=double. This function returns the electron temperature.</p>
</dd>
<dt class="field-even">Keywords</dt>
<dd class="field-even"><dl class="simple">
<dt>line_flux_ratio<span class="classifier">in, required, type=float</span></dt><dd><p>flux intensity ratio</p>
</dd>
<dt>density<span class="classifier">in, required, type=float</span></dt><dd><p>electron density</p>
</dd>
<dt>upper_levels<span class="classifier">in, required, type=string,</span></dt><dd><p>upper atomic level(s) e.g ‘1,2/’, ‘1,2,1,3/’</p>
</dd>
<dt>lower_levels<span class="classifier">in, required, type=string</span></dt><dd><p>lower atomic level(s) e.g ‘1,2/’, ‘1,2,1,3/’</p>
</dd>
<dt>elj_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>energy levels (Ej) data</p>
</dd>
<dt>omij_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>collision strengths (omega_ij) data</p>
</dd>
<dt>aij_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>transition probabilities (Aij) data</p>
</dd>
<dt>low_temperature<span class="classifier">in, optional, type=float</span></dt><dd><p>lower temperature range</p>
</dd>
<dt>high_temperature<span class="classifier">in, optional, type=float</span></dt><dd><p>upper temperature range</p>
</dd>
<dt>num_temperature<span class="classifier">in, optional, type=integer</span></dt><dd><p>number of the iteration step</p>
</dd>
<dt>min_density<span class="classifier">in, optional, type=float</span></dt><dd><p>lower density range</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Examples</dt>
<dd class="field-odd"><p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyequib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomneb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="s1">&#39;../externals/atomneb/&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;atomic-data&#39;</span><span class="p">,</span> <span class="s1">&#39;chianti70&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_elj_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;AtomElj.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_omij_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;AtomOmij.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_aij_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;AtomAij.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;s&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ion</span><span class="o">=</span><span class="s1">&#39;ii&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_ii_elj</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_elj</span><span class="p">(</span><span class="n">atom_elj_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">,</span> <span class="n">level_num</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># read Energy Levels (Ej)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_ii_omij</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_omij</span><span class="p">(</span><span class="n">atom_omij_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span> <span class="c1"># read Collision Strengths (Omegaij)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_ii_aij</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_aij</span><span class="p">(</span><span class="n">atom_aij_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span> <span class="c1"># read Transition Probabilities (Aij)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">upper_levels</span><span class="o">=</span><span class="s1">&#39;1,2,1,3/&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lower_levels</span><span class="o">=</span><span class="s1">&#39;1,5/&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">density</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mi">2550</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">line_flux_ratio</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">10.753</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">temperature</span><span class="o">=</span><span class="n">pyequib</span><span class="o">.</span><span class="n">calc_temperature</span><span class="p">(</span><span class="n">line_flux_ratio</span><span class="o">=</span><span class="n">line_flux_ratio</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="n">density</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                             <span class="n">upper_levels</span><span class="o">=</span><span class="n">upper_levels</span><span class="p">,</span> <span class="n">lower_levels</span><span class="o">=</span><span class="n">lower_levels</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                             <span class="n">elj_data</span><span class="o">=</span><span class="n">s_ii_elj</span><span class="p">,</span> <span class="n">omij_data</span><span class="o">=</span><span class="n">s_ii_omij</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                             <span class="n">aij_data</span><span class="o">=</span><span class="n">s_ii_aij</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Electron Temperature:&quot;</span><span class="p">,</span> <span class="n">temperature</span><span class="p">)</span>
<span class="go">   Electron Temperature:       7920.2865</span>
</pre></div>
</div>
</dd>
<dt class="field-even">Categories</dt>
<dd class="field-even"><p>Plasma Diagnostics, Collisionally Excited Lines</p>
</dd>
<dt class="field-odd">Dirs</dt>
<dd class="field-odd"><dl class="simple">
<dt>./</dt><dd><p>Main routines</p>
</dd>
</dl>
</dd>
<dt class="field-even">Author</dt>
<dd class="field-even"><p>Ashkbiz Danehkar</p>
</dd>
<dt class="field-odd">Copyright</dt>
<dd class="field-odd"><p>This library is released under a GNU General Public License.</p>
</dd>
<dt class="field-even">Version</dt>
<dd class="field-even"><p>0.3.0</p>
</dd>
<dt class="field-odd">History</dt>
<dd class="field-odd"><p>15/09/2013, A. Danehkar, Translated from FORTRAN to IDL code.</p>
<p>20/10/2016, A. Danehkar, Replaced str2int with strnumber.</p>
<dl class="simple">
<dt>20/10/2016, A. Danehkar, Replaced CFY, SPLMAT, and CFD with</dt><dd><p>IDL function INTERPOL( /SPLINE).</p>
</dd>
<dt>20/10/2016, A. Danehkar, Replaced LUSLV with IDL LAPACK function</dt><dd><p>LA_LINEAR_EQUATION.</p>
</dd>
<dt>15/11/2016, A. Danehkar, Replaced LA_LINEAR_EQUATION (not work in GDL)</dt><dd><p>with IDL function LUDC &amp; LUSOL.</p>
</dd>
<dt>19/11/2016, A. Danehkar, Replaced INTERPOL (not accurate) with</dt><dd><p>SPL_INIT &amp; SPL_INTERP.</p>
</dd>
<dt>20/11/2016, A. Danehkar, Made a new function calc_populations()</dt><dd><p>for solving atomic level populations and separated it from
calc_abundance(), calc_density() and calc_temperature().</p>
</dd>
<dt>10/03/2017, A. Danehkar, Integration with AtomNeb, now uses atomic data</dt><dd><p>input elj_data, omij_data, aij_data.</p>
</dd>
<dt>12/06/2017, A. Danehkar, Cleaning the function, and remove unused varibales</dt><dd><p>from calc_temperature().</p>
</dd>
<dt>27/02/2019, A. Danehkar, Fix a bug in the atomic level assumption, and</dt><dd><p>use the simplified calc_populations() routine.</p>
</dd>
</dl>
<p>04/03/2019, A. Danehkar, Use the get_omij_temp() routine.</p>
<p>24/05/2019, A. Danehkar, Add the optional temperature range.</p>
<p>03/10/2020, A. Danehkar, Transferred from IDL to Python.</p>
</dd>
</dl>
<p>FORTRAN HISTORY:</p>
<blockquote>
<div><p>03/05/1981, I.D.Howarth,  Version 1.</p>
<p>05/05/1981, I.D.Howarth,  Minibug fixed!</p>
<p>07/05/1981, I.D.Howarth,  Now takes collision rates or strengths.</p>
<p>03/08/1981, S.Adams,      Interpolates collision strengths.</p>
<p>07/08/1981, S.Adams,      Input method changed.</p>
<dl class="simple">
<dt>19/11/1984, R.E.S.Clegg,  SA files entombed in scratch disk. Logical</dt><dd><p>filenames given to SA’s data files.</p>
</dd>
</dl>
<p>08/1995, D.P.Ruffle, Changed input file format. Increased matrices.</p>
<dl class="simple">
<dt>02/1996, X.W.Liu,   Tidy up. SUBROUTINES SPLMAT, HGEN, CFY and CFD</dt><dd><p>modified such that matrix sizes (i.e. maximum
of Te and maximum no of levels) can now be cha
by modifying the parameters NDIM1, NDIM2 and N
in the Main program. EASY!
Now takes collision rates as well.
All variables are declared explicitly
Generate two extra files (ionpop.lis and ionra
of plain stream format for plotting.</p>
</dd>
<dt>06/1996, C.J.Pritchet, Changed input data format for cases IBIG=1,2.</dt><dd><p>Fixed readin bug for IBIG=2 case.
Now reads reformatted upsilons (easier to see
and the 0 0 0 data end is excluded for these c
The A values have a different format for IBIG=.</p>
</dd>
</dl>
<p>2006, B.Ercolano,   Converted to F90.</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt id="pyequib.deredden_flux">
<code class="sig-prename descclassname">pyequib.</code><code class="sig-name descname">deredden_flux</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wavelength</span></em>, <em class="sig-param"><span class="n">flux</span></em>, <em class="sig-param"><span class="n">m_ext</span></em>, <em class="sig-param"><span class="n">ext_law</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">rv</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fmlaw</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyequib.html#deredden_flux"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyequib.deredden_flux" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><blockquote>
<div><p>This function dereddens absolute flux intensity based on the reddening law.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>type=double. This function returns the deredden flux intensity.</p>
</dd>
<dt class="field-even">Params</dt>
<dd class="field-even"><dl class="simple">
<dt>wavelength<span class="classifier">in, required, type=float/array</span></dt><dd><p>Wavelength in Angstrom</p>
</dd>
<dt>flux<span class="classifier">in, required, type=float,</span></dt><dd><p>absolute flux intensity</p>
</dd>
<dt>m_ext<span class="classifier">in, required, type=float,</span></dt><dd><p>logarithmic extinction</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Keywords</dt>
<dd class="field-odd"><dl>
<dt>ext_law<span class="classifier">in, optional, type=string, default=’GAL’</span></dt><dd><p>the extinction law:</p>
<p>‘GAL’ for Howarth Galactic.</p>
<p>‘GAL2’ for Savage and Mathis.</p>
<p>‘CCM’ for CCM galactic.</p>
<p>‘JBK’ for Whitford, Seaton, Kaler.</p>
<p>‘FM’ for Fitxpatrick.</p>
<p>‘SMC’ for Prevot SMC.</p>
<p>‘LMC’ for Howarth LMC.</p>
</dd>
<dt>rv<span class="classifier">in, optional, type=float, default=3.1</span></dt><dd><p>the optical total-to-selective extinction ratio, RV = A(V)/E(B-V).</p>
</dd>
<dt>fmlaw<span class="classifier">in, optional, type=string, default=’GAL’</span></dt><dd><p>the fmlaw keyword is used only in the redlaw_fm function:</p>
<dl class="simple">
<dt>‘GAL’ for  the default fit parameters for the R-dependent</dt><dd><p>Galactic extinction curve from Fitzpatrick &amp; Massa
(Fitzpatrick, 1999, PASP, 111, 63).</p>
</dd>
<dt>‘LMC2’ for the fit parameters are those determined for</dt><dd><p>reddening the LMC2 field (inc. 30 Dor)
from Misselt et al.  (1999, ApJ, 515, 128).</p>
</dd>
<dt>‘AVGLMC’ for  the fit parameters are those determined for</dt><dd><p>reddening in the general Large Magellanic Cloud (LMC)
field by Misselt et al.  (1999, ApJ, 515, 128).</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Examples</dt>
<dd class="field-odd"><blockquote>
<div><p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyequib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelength</span><span class="o">=</span><span class="mf">6563.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ext_law</span><span class="o">=</span><span class="s1">&#39;GAL&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r_v</span><span class="o">=</span><span class="mf">3.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m_ext</span><span class="o">=</span><span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flux</span><span class="o">=</span><span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flux_deredden</span><span class="o">=</span><span class="n">pyequib</span><span class="o">.</span><span class="n">deredden_flux</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span> <span class="n">m_ext</span><span class="p">,</span> <span class="n">ext_law</span><span class="o">=</span><span class="n">ext_law</span><span class="p">,</span> <span class="n">rv</span><span class="o">=</span><span class="n">r_v</span><span class="p">)</span> <span class="c1"># deredden absolute flux intensity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;dereddened flux(6563):&#39;</span><span class="p">,</span> <span class="n">flux_deredden</span><span class="p">)</span>
<span class="go">   dereddened flux(6563):       4.7847785</span>
</pre></div>
</div>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Categories</dt>
<dd class="field-odd"><p>Interstellar Extinction</p>
</dd>
<dt class="field-even">Dirs</dt>
<dd class="field-even"><dl class="simple">
<dt>./</dt><dd><p>Main routines</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Author</dt>
<dd class="field-odd"><p>Ashkbiz Danehkar</p>
</dd>
<dt class="field-even">Copyright</dt>
<dd class="field-even"><p>This library is released under a GNU General Public License.</p>
</dd>
<dt class="field-odd">Version</dt>
<dd class="field-odd"><p>0.3.0</p>
</dd>
<dt class="field-even">History</dt>
<dd class="field-even"><p>31/08/2012, A. Danehkar, IDL code.</p>
<p>03/10/2020, A. Danehkar, Transferred from IDL to Python.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyequib.deredden_relflux">
<code class="sig-prename descclassname">pyequib.</code><code class="sig-name descname">deredden_relflux</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wavelength</span></em>, <em class="sig-param"><span class="n">relflux</span></em>, <em class="sig-param"><span class="n">m_ext</span></em>, <em class="sig-param"><span class="n">ext_law</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">rv</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fmlaw</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyequib.html#deredden_relflux"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyequib.deredden_relflux" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><blockquote>
<div><p>This function dereddens flux intensity relative to Hb=100,  based on the reddening law.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>type=double. This function returns the deredden flux intensity relative to Hb=100.</p>
</dd>
<dt class="field-even">Params</dt>
<dd class="field-even"><dl class="simple">
<dt>wavelength<span class="classifier">in, required, type=float/array</span></dt><dd><p>Wavelength in Angstrom</p>
</dd>
<dt>relflux<span class="classifier">in, required, type=float,</span></dt><dd><p>flux intensity relative to Hb=100</p>
</dd>
<dt>m_ext<span class="classifier">in, required, type=float,</span></dt><dd><p>logarithmic extinction</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Keywords</dt>
<dd class="field-odd"><dl>
<dt>ext_law<span class="classifier">in, optional, type=string, default=’GAL’</span></dt><dd><p>the extinction law:</p>
<p>‘GAL’ for Howarth Galactic.</p>
<p>‘GAL2’ for Savage and Mathis.</p>
<p>‘CCM’ for CCM galactic.</p>
<p>‘JBK’ for Whitford, Seaton, Kaler.</p>
<p>‘FM’ for Fitxpatrick.</p>
<p>‘SMC’ for Prevot SMC.</p>
<p>‘LMC’ for Howarth LMC.</p>
</dd>
<dt>rv<span class="classifier">in, optional, type=float, default=3.1</span></dt><dd><p>the optical total-to-selective extinction ratio, RV = A(V)/E(B-V).</p>
</dd>
<dt>fmlaw<span class="classifier">in, optional, type=string, default=’GAL’</span></dt><dd><p>the fmlaw keyword is used only in the redlaw_fm function:</p>
<dl class="simple">
<dt>‘GAL’ for  the default fit parameters for the R-dependent</dt><dd><p>Galactic extinction curve from Fitzpatrick &amp; Massa
(Fitzpatrick, 1999, PASP, 111, 63).</p>
</dd>
<dt>‘LMC2’ for the fit parameters are those determined for</dt><dd><p>reddening the LMC2 field (inc. 30 Dor)
from Misselt et al.  (1999, ApJ, 515, 128).</p>
</dd>
<dt>‘AVGLMC’ for  the fit parameters are those determined for</dt><dd><p>reddening in the general Large Magellanic Cloud (LMC)
field by Misselt et al.  (1999, ApJ, 515, 128).</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Examples</dt>
<dd class="field-odd"><blockquote>
<div><p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyequib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelength</span><span class="o">=</span><span class="mf">6563.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ext_law</span><span class="o">=</span><span class="s1">&#39;GAL&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r_v</span><span class="o">=</span><span class="mf">3.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m_ext</span><span class="o">=</span><span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flux</span><span class="o">=</span><span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flux_deredden</span><span class="o">=</span><span class="n">pyequib</span><span class="o">.</span><span class="n">deredden_relflux</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span> <span class="n">m_ext</span><span class="p">,</span> <span class="n">ext_law</span><span class="o">=</span><span class="n">ext_law</span><span class="p">,</span> <span class="n">rv</span><span class="o">=</span><span class="n">r_v</span><span class="p">)</span> <span class="c1"># deredden absolute flux intensity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;dereddened relative flux(6563):&#39;</span><span class="p">,</span> <span class="n">flux_deredden</span><span class="p">)</span>
<span class="go">   dereddened relative flux(6563):       0.47847785</span>
</pre></div>
</div>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Categories</dt>
<dd class="field-odd"><p>Interstellar Extinction</p>
</dd>
<dt class="field-even">Dirs</dt>
<dd class="field-even"><dl class="simple">
<dt>./</dt><dd><p>Main routines</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Author</dt>
<dd class="field-odd"><p>Ashkbiz Danehkar</p>
</dd>
<dt class="field-even">Copyright</dt>
<dd class="field-even"><p>This library is released under a GNU General Public License.</p>
</dd>
<dt class="field-odd">Version</dt>
<dd class="field-odd"><p>0.3.0</p>
</dd>
<dt class="field-even">History</dt>
<dd class="field-even"><p>31/08/2012, A. Danehkar, IDL code.</p>
<p>03/10/2020, A. Danehkar, Transferred from IDL to Python.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyequib.get_omij_temp">
<code class="sig-prename descclassname">pyequib.</code><code class="sig-name descname">get_omij_temp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">temperature</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">omij_data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">elj_data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">level_num</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">irats</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyequib.html#get_omij_temp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyequib.get_omij_temp" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This function derives the effective collision strengths (Omij_T) from
the collision strengths (omega_ij) data for the given temperature.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>type=array/object. This function returns the effective collision strengths (Omij_T).</p>
</dd>
<dt class="field-even">Keywords</dt>
<dd class="field-even"><dl class="simple">
<dt>temperature<span class="classifier">in, required, type=float</span></dt><dd><p>electron temperature</p>
</dd>
<dt>omij_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>collision strengths (omega_ij) data</p>
</dd>
<dt>level_num<span class="classifier">in, type=int</span></dt><dd><p>Number of levels</p>
</dd>
<dt>irats<span class="classifier">in, type=int</span></dt><dd><p>Else Coll. rates = tabulated values * 10 ** irats</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Examples</dt>
<dd class="field-odd"><p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyequib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomneb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="s1">&#39;../externals/atomneb/&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;atomic-data&#39;</span><span class="p">,</span> <span class="s1">&#39;chianti70&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_elj_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;AtomElj.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_omij_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;AtomOmij.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_aij_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;AtomAij.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;s&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ion</span><span class="o">=</span><span class="s1">&#39;ii&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_ii_elj</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_elj</span><span class="p">(</span><span class="n">atom_elj_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">,</span> <span class="n">level_num</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># read Energy Levels (Ej)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_ii_omij</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_omij</span><span class="p">(</span><span class="n">atom_omij_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span> <span class="c1"># read Collision Strengths (Omegaij)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_ii_aij</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_aij</span><span class="p">(</span><span class="n">atom_aij_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span> <span class="c1"># read Transition Probabilities (Aij)        &gt;&gt;&gt; temperature=np.float64(10000.0)#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">omij_t</span><span class="o">=</span><span class="n">pyequib</span><span class="o">.</span><span class="n">get_omij_temp</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span> <span class="n">omij_data</span><span class="o">=</span><span class="n">s_ii_omij</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Effective Collision Strengths: &#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">omij_t</span><span class="p">)</span>
<span class="go">   Effective Collision Strengths:</span>
<span class="go">   0.0000000       0.0000000       0.0000000       0.0000000       0.0000000</span>
<span class="go">   2.7800000       0.0000000       0.0000000       0.0000000       0.0000000</span>
<span class="go">   4.1600000       7.4600000       0.0000000       0.0000000       0.0000000</span>
<span class="go">   1.1700000       1.8000000       2.2000000       0.0000000       0.0000000</span>
<span class="go">   2.3500000       3.0000000       4.9900000       2.7100000       0.0000000</span>
</pre></div>
</div>
</dd>
<dt class="field-even">Categories</dt>
<dd class="field-even"><p>Plasma Diagnostics, Abundance Analysis, Collisionally Excited Lines</p>
</dd>
<dt class="field-odd">Dirs</dt>
<dd class="field-odd"><dl class="simple">
<dt>./</dt><dd><p>Subroutines</p>
</dd>
</dl>
</dd>
<dt class="field-even">Author</dt>
<dd class="field-even"><p>Ashkbiz Danehkar</p>
</dd>
<dt class="field-odd">Copyright</dt>
<dd class="field-odd"><p>This library is released under a GNU General Public License.</p>
</dd>
<dt class="field-even">Version</dt>
<dd class="field-even"><p>0.3.0</p>
</dd>
<dt class="field-odd">History</dt>
<dd class="field-odd"><p>04/03/2019, A. Danehkar, create the get_omij_temp() routine.</p>
<p>03/10/2020, A. Danehkar, Transferred from IDL to Python.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyequib.print_ionic">
<code class="sig-prename descclassname">pyequib.</code><code class="sig-name descname">print_ionic</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">temperature</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">density</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">elj_data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">omij_data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">aij_data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h_i_aeff_data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">printemissivity</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">printpopulations</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">printcritdensity</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyequib.html#print_ionic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyequib.print_ionic" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This function prints the atom’s transitions information,
atomic level populations, critical densities, and emissivities
for given temperature and density.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Keywords</dt>
<dd class="field-odd"><dl class="simple">
<dt>temperature<span class="classifier">in, required, type=float</span></dt><dd><p>electron temperature</p>
</dd>
<dt>density<span class="classifier">in, required, type=float</span></dt><dd><p>electron density</p>
</dd>
<dt>elj_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>energy levels (Ej) data</p>
</dd>
<dt>omij_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>collision strengths (omega_ij) data</p>
</dd>
<dt>aij_data<span class="classifier">in, required, type=array/object</span></dt><dd><p>transition probabilities (Aij) data</p>
</dd>
<dt>h_i_aeff_data<span class="classifier">in, type=array/object</span></dt><dd><p>H I recombination coefficients</p>
</dd>
<dt>printEmissivity<span class="classifier">in, type=boolean</span></dt><dd><p>Set for printing Emissivities</p>
</dd>
<dt>printPopulations<span class="classifier">in, type=boolean</span></dt><dd><p>Set for printing Populations</p>
</dd>
<dt>printCritDensity<span class="classifier">in, type=boolean</span></dt><dd><p>Set for printing Critical Densities</p>
</dd>
</dl>
</dd>
<dt class="field-even">Examples</dt>
<dd class="field-even"><p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyequib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomneb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base_dir</span> <span class="o">=</span> <span class="s1">&#39;../externals/atomneb/&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;atomic-data&#39;</span><span class="p">,</span> <span class="s1">&#39;chianti70&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_elj_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;AtomElj.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_omij_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;AtomOmij.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_aij_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;AtomAij.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_rc_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;atomic-data-rc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_rc_sh95_file</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span><span class="n">data_rc_dir</span><span class="p">,</span> <span class="s1">&#39;rc_SH95.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;o&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ion</span><span class="o">=</span><span class="s1">&#39;iii&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o_iii_elj</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_elj</span><span class="p">(</span><span class="n">atom_elj_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">,</span> <span class="n">level_num</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># read Energy Levels (Ej)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o_iii_omij</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_omij</span><span class="p">(</span><span class="n">atom_omij_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span> <span class="c1"># read Collision Strengths (Omegaij)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o_iii_aij</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_aij</span><span class="p">(</span><span class="n">atom_aij_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span> <span class="c1"># read Transition Probabilities (Aij)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;h&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ion</span><span class="o">=</span><span class="s1">&#39;ii&#39;</span> <span class="c1"># H I</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hi_rc_data</span><span class="o">=</span><span class="n">atomneb</span><span class="o">.</span><span class="n">read_aeff_sh95</span><span class="p">(</span><span class="n">atom_rc_sh95_file</span><span class="p">,</span> <span class="n">atom</span><span class="p">,</span> <span class="n">ion</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">temperature</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">10000.0</span><span class="p">)</span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">density</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">1000.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pyequib</span><span class="o">.</span><span class="n">print_ionic</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="n">density</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>             <span class="n">elj_data</span><span class="o">=</span><span class="n">o_iii_elj</span><span class="p">,</span> <span class="n">omij_data</span><span class="o">=</span><span class="n">o_iii_omij</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>             <span class="n">aij_data</span><span class="o">=</span><span class="n">o_iii_aij</span><span class="p">,</span> <span class="n">h_i_aeff_data</span><span class="o">=</span><span class="n">hi_rc_data</span><span class="p">[</span><span class="s1">&#39;aeff&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="go">   Temperature =   10000.0 K</span>
<span class="go">   Density =    1000.0 cm-3</span>

<span class="go">   Level    Populations   Critical Densities</span>
<span class="go">   Level 1:   3.063E-01   0.000E+00</span>
<span class="go">   Level 2:   4.896E-01   4.908E+02</span>
<span class="go">   Level 3:   2.041E-01   3.419E+03</span>
<span class="go">   Level 4:   4.427E-05   6.853E+05</span>
<span class="go">   Level 5:   2.985E-09   2.547E+07</span>

<span class="go">    2.597E-05</span>
<span class="go">        88.34um</span>
<span class="go">       (2--&gt;1)</span>
<span class="go">    2.859E-22</span>

<span class="go">    0.000E+00   9.632E-05</span>
<span class="go">        32.66um      51.81um</span>
<span class="go">       (3--&gt;1)     (3--&gt;2)</span>
<span class="go">    0.000E+00   7.536E-22</span>

<span class="go">    2.322E-06   6.791E-03   2.046E-02</span>
<span class="go">      4932.60A    4960.29A    5008.24A</span>
<span class="go">       (4--&gt;1)     (4--&gt;2)     (4--&gt;3)</span>
<span class="go">    4.140E-25   1.204E-21   3.593E-21</span>

<span class="go">    0.000E+00   2.255E-01   6.998E-04   1.685E+00</span>
<span class="go">      2315.58A    2321.67A    2332.12A    4364.45A</span>
<span class="go">       (5--&gt;1)     (5--&gt;2)     (5--&gt;3)     (5--&gt;4)</span>
<span class="go">    0.000E+00   5.759E-24   1.779E-26   2.289E-23</span>

<span class="go">   H-beta emissivity: 1.237E-25 N(H+) Ne  [erg/s]</span>
</pre></div>
</div>
</dd>
<dt class="field-odd">Categories</dt>
<dd class="field-odd"><p>Plasma Diagnostics, Abundance Analysis, Collisionally Excited Lines</p>
</dd>
<dt class="field-even">Dirs</dt>
<dd class="field-even"><dl class="simple">
<dt>./</dt><dd><p>Main routines</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Author</dt>
<dd class="field-odd"><p>Ashkbiz Danehkar</p>
</dd>
<dt class="field-even">Copyright</dt>
<dd class="field-even"><p>This library is released under a GNU General Public License.</p>
</dd>
<dt class="field-odd">Version</dt>
<dd class="field-odd"><p>0.3.0</p>
</dd>
<dt class="field-even">History</dt>
<dd class="field-even"><p>04/03/2019, A. Danehkar, create the print_ionic() routine.</p>
<p>03/10/2020, A. Danehkar, Transferred from IDL to Python.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyequib.redlaw">
<code class="sig-prename descclassname">pyequib.</code><code class="sig-name descname">redlaw</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wavelength</span></em>, <em class="sig-param"><span class="n">ext_law</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">rv</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fmlaw</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyequib.html#redlaw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyequib.redlaw" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><blockquote>
<div><p>This function determines the reddening law function of the line at the given wavelength
for the used extinction law.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>type=double/array. This function returns the reddening law function value for the given wavelength.</p>
</dd>
<dt class="field-even">Params</dt>
<dd class="field-even"><dl class="simple">
<dt>wavelength<span class="classifier">in, required, type=float/array</span></dt><dd><p>Wavelength in Angstrom</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Keywords</dt>
<dd class="field-odd"><dl>
<dt>ext_law<span class="classifier">in, optional, type=string, default=’GAL’</span></dt><dd><p>the extinction law:</p>
<p>‘GAL’ for Howarth Galactic.</p>
<p>‘GAL2’ for Savage and Mathis.</p>
<p>‘CCM’ for CCM galactic.</p>
<p>‘JBK’ for Whitford, Seaton, Kaler.</p>
<p>‘FM’ for Fitxpatrick.</p>
<p>‘SMC’ for Prevot SMC.</p>
<p>‘LMC’ for Howarth LMC.</p>
</dd>
<dt>rv<span class="classifier">in, optional, type=float, default=3.1</span></dt><dd><p>the optical total-to-selective extinction ratio, RV = A(V)/E(B-V).</p>
</dd>
<dt>fmlaw<span class="classifier">in, optional, type=string, default=’GAL’</span></dt><dd><p>the fmlaw keyword is used only in the redlaw_fm function:</p>
<dl class="simple">
<dt>‘GAL’ for  the default fit parameters for the R-dependent</dt><dd><p>Galactic extinction curve from Fitzpatrick &amp; Massa
(Fitzpatrick, 1999, PASP, 111, 63).</p>
</dd>
<dt>‘LMC2’ for the fit parameters are those determined for</dt><dd><p>reddening the LMC2 field (inc. 30 Dor)
from Misselt et al.  (1999, ApJ, 515, 128).</p>
</dd>
<dt>‘AVGLMC’ for  the fit parameters are those determined for</dt><dd><p>reddening in the general Large Magellanic Cloud (LMC)
field by Misselt et al.  (1999, ApJ, 515, 128).</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Examples</dt>
<dd class="field-odd"><blockquote>
<div><p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyequib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelength</span><span class="o">=</span><span class="mf">6563.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r_v</span><span class="o">=</span><span class="mf">3.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl</span><span class="o">=</span><span class="n">pyequib</span><span class="o">.</span><span class="n">redlaw</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">rv</span><span class="o">=</span><span class="n">r_v</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fl(6563)&#39;</span><span class="p">,</span> <span class="n">fl</span><span class="p">)</span>
<span class="go">   fl(6563)     -0.32013816</span>
</pre></div>
</div>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Categories</dt>
<dd class="field-odd"><p>Interstellar Extinction</p>
</dd>
<dt class="field-even">Dirs</dt>
<dd class="field-even"><dl class="simple">
<dt>./</dt><dd><p>Main routines</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Author</dt>
<dd class="field-odd"><p>Ashkbiz Danehkar</p>
</dd>
<dt class="field-even">Copyright</dt>
<dd class="field-even"><p>This library is released under a GNU General Public License.</p>
</dd>
<dt class="field-odd">Version</dt>
<dd class="field-odd"><p>0.3.0</p>
</dd>
<dt class="field-even">History</dt>
<dd class="field-even"><p>Originally from IRAF STSDAS SYNPHOT redlaw.x, ebmvxfunc.x</p>
<p>31/08/2012, A. Danehkar, Converted to IDL code.</p>
<p>03/10/2020, A. Danehkar, Transferred from IDL to Python.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyequib.redlaw_ccm">
<code class="sig-prename descclassname">pyequib.</code><code class="sig-name descname">redlaw_ccm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wavelength</span></em>, <em class="sig-param"><span class="n">rv</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyequib.html#redlaw_ccm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyequib.redlaw_ccm" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><blockquote>
<div><p>This function determines the reddening law function of Cardelli, Clayton &amp; Mathis.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>type=double/array. This function returns the reddening law function value for the given wavelength.</p>
</dd>
<dt class="field-even">Params</dt>
<dd class="field-even"><dl class="simple">
<dt>wavelength<span class="classifier">in, required, type=float/array</span></dt><dd><p>Wavelength in Angstrom</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Keywords</dt>
<dd class="field-odd"><dl class="simple">
<dt>RV<span class="classifier">in, optional, type=float, default=3.1</span></dt><dd><p>the optical total-to-selective extinction ratio, RV = A(V)/E(B-V).</p>
</dd>
</dl>
</dd>
</dl>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Examples</dt>
<dd class="field-odd"><blockquote>
<div><p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyequib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelength</span><span class="o">=</span><span class="mf">6563.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r_v</span><span class="o">=</span><span class="mf">3.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl</span><span class="o">=</span><span class="n">pyequib</span><span class="o">..</span><span class="n">redlaw_ccm</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">rv</span><span class="o">=</span><span class="n">r_v</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fl(6563)&#39;</span><span class="p">,</span> <span class="n">fl</span><span class="p">)</span>
<span class="go">   fl(6563)     -0.29756615</span>
</pre></div>
</div>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Categories</dt>
<dd class="field-odd"><p>Interstellar Extinction</p>
</dd>
<dt class="field-even">Dirs</dt>
<dd class="field-even"><dl class="simple">
<dt>./</dt><dd><p>Subroutines</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Author</dt>
<dd class="field-odd"><p>Ashkbiz Danehkar</p>
</dd>
<dt class="field-even">Copyright</dt>
<dd class="field-even"><p>This library is released under a GNU General Public License.</p>
</dd>
<dt class="field-odd">Version</dt>
<dd class="field-odd"><p>0.3.0</p>
</dd>
<dt class="field-even">History</dt>
<dd class="field-even"><p>Based on Formulae by Cardelli, Clayton &amp; Mathis 1989, ApJ 345, 245-256.
1989ApJ…345..245C</p>
<p>Originally from IRAF STSDAS SYNPHOT redlaw.x</p>
<dl class="simple">
<dt>18/05/1993, R. A. Shaw, Initial IRAF implementation, based upon CCM module</dt><dd><p>in onedspec.deredden.</p>
</dd>
</dl>
<p>31/08/2012, A. Danehkar, Converted to IDL code.</p>
<p>03/10/2020, A. Danehkar, Transferred from IDL to Python.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyequib.redlaw_fm">
<code class="sig-prename descclassname">pyequib.</code><code class="sig-name descname">redlaw_fm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wavelength</span></em>, <em class="sig-param"><span class="n">rv</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fmlaw</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyequib.html#redlaw_fm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyequib.redlaw_fm" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><blockquote>
<div><p>This function determines the reddening law function by Fitzpatrick &amp; Massa
for the line at the given wavelength.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>type=double/array. This function returns the reddening law function value for the given wavelength.</p>
</dd>
<dt class="field-even">Params</dt>
<dd class="field-even"><dl class="simple">
<dt>wavelength<span class="classifier">in, required, type=float/array</span></dt><dd><p>Wavelength in Angstrom</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Keywords</dt>
<dd class="field-odd"><dl>
<dt>RV<span class="classifier">in, optional, type=float, default=3.1</span></dt><dd><p>the optical total-to-selective extinction ratio, RV = A(V)/E(B-V).</p>
</dd>
<dt>fmlaw<span class="classifier">in, optional, type=string, default=’GAL’</span></dt><dd><p>the fmlaw keyword is used only in the redlaw_fm function:</p>
<dl class="simple">
<dt>‘GAL’ for  the default fit parameters for the R-dependent</dt><dd><p>Galactic extinction curve from Fitzpatrick &amp; Massa
(Fitzpatrick, 1999, PASP, 111, 63).</p>
</dd>
<dt>‘LMC2’ for the fit parameters are those determined for</dt><dd><p>reddening the LMC2 field (inc. 30 Dor)
from Misselt et al.  (1999, ApJ, 515, 128).</p>
</dd>
<dt>‘AVGLMC’ for  the fit parameters are those determined for</dt><dd><p>reddening in the general Large Magellanic Cloud (LMC)
field by Misselt et al.  (1999, ApJ, 515, 128).</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Examples</dt>
<dd class="field-odd"><blockquote>
<div><p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyequib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelength</span><span class="o">=</span><span class="mf">6563.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r_v</span><span class="o">=</span><span class="mf">3.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl</span><span class="o">=</span><span class="n">pyequib</span><span class="o">.</span><span class="n">redlaw_fm</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">rv</span><span class="o">=</span><span class="n">r_v</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fl(6563)&#39;</span><span class="p">,</span> <span class="n">fl</span><span class="p">)</span>
<span class="go">   fl(6563)     -0.35054942</span>
</pre></div>
</div>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Categories</dt>
<dd class="field-odd"><p>Interstellar Extinction</p>
</dd>
<dt class="field-even">Dirs</dt>
<dd class="field-even"><dl class="simple">
<dt>./</dt><dd><p>Subroutines</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Author</dt>
<dd class="field-odd"><p>Ashkbiz Danehkar</p>
</dd>
<dt class="field-even">Copyright</dt>
<dd class="field-even"><p>This library is released under a GNU General Public License.</p>
</dd>
<dt class="field-odd">Version</dt>
<dd class="field-odd"><p>0.3.0</p>
</dd>
<dt class="field-even">History</dt>
<dd class="field-even"><p>Based on Formulae by Fitzpatrick 1999, PASP, 11, 63
1999PASP..111…63F, Fitzpatrick &amp; Massa 1990,
ApJS, 72, 163, 1990ApJS…72..163F</p>
<p>Adopted from NASA IDL Library &amp; PyAstronomy.</p>
<p>30/12/2016, A. Danehkar, Revised in IDL code.</p>
<p>03/10/2020, A. Danehkar, Transferred from IDL to Python.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyequib.redlaw_gal">
<code class="sig-prename descclassname">pyequib.</code><code class="sig-name descname">redlaw_gal</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wavelength</span></em>, <em class="sig-param"><span class="n">rv</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyequib.html#redlaw_gal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyequib.redlaw_gal" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This function determines the reddening law function of the line at the given wavelength
for Galactic Seaton1979+Howarth1983+CCM1983.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>type=double/array. This function returns the reddening law function value(s) for the given wavelength(s).</p>
</dd>
<dt class="field-even">Params</dt>
<dd class="field-even"><dl class="simple">
<dt>wavelength<span class="classifier">in, required, type=float</span></dt><dd><p>Wavelength in Angstrom</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Keywords</dt>
<dd class="field-odd"><dl class="simple">
<dt>rv<span class="classifier">in, optional, type=float, default=3.1</span></dt><dd><p>the optical total-to-selective extinction ratio, RV = A(V)/E(B-V).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Examples</dt>
<dd class="field-even"><p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyequib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelength</span><span class="o">=</span><span class="mf">6563.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r_v</span><span class="o">=</span><span class="mf">3.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl</span><span class="o">=</span><span class="n">pyequib</span><span class="o">.</span><span class="n">redlaw_gal</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">rv</span><span class="o">=</span><span class="n">r_v</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fl(6563)&#39;</span><span class="p">,</span> <span class="n">fl</span><span class="p">)</span>
<span class="go">   fl(6563)     -0.32013816</span>
</pre></div>
</div>
</dd>
<dt class="field-odd">Categories</dt>
<dd class="field-odd"><p>Interstellar Extinction</p>
</dd>
<dt class="field-even">Dirs</dt>
<dd class="field-even"><dl class="simple">
<dt>./</dt><dd><p>Subroutines</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Author</dt>
<dd class="field-odd"><p>Ashkbiz Danehkar</p>
</dd>
<dt class="field-even">Copyright</dt>
<dd class="field-even"><p>This library is released under a GNU General Public License.</p>
</dd>
<dt class="field-odd">Version</dt>
<dd class="field-odd"><p>0.3.0</p>
</dd>
<dt class="field-even">History</dt>
<dd class="field-even"><p>Based on the UV Formulae from Seaton 1979, MNRAS, 187, 73
1979MNRAS.187P..73S, the opt/NIR from Howarth 1983, MNRAS, 203, 301
the FIR from Cardelli, Clayton and Mathis 1989, ApJ, 345, 245
1989ApJ…345..245C</p>
<p>Originally from IRAF STSDAS SYNPHOT ebmvxfunc.x, pyneb.extinction</p>
<p>31/08/2012, A. Danehkar, Converted to IDL code.</p>
<p>03/10/2020, A. Danehkar, Transferred from IDL to Python.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyequib.redlaw_gal2">
<code class="sig-prename descclassname">pyequib.</code><code class="sig-name descname">redlaw_gal2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wavelength</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyequib.html#redlaw_gal2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyequib.redlaw_gal2" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This function determines the reddening law function of the line at the given wavelength
for Galactic Savage &amp; Mathis 1979.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>type=double/array. This function returns the reddening law function value(s) for the given wavelength(s).</p>
</dd>
<dt class="field-even">Params</dt>
<dd class="field-even"><dl class="simple">
<dt>wavelength<span class="classifier">in, required, type=float</span></dt><dd><p>Wavelength in Angstrom</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Examples</dt>
<dd class="field-odd"><p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyequib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelength</span><span class="o">=</span><span class="mf">6563.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl</span><span class="o">=</span><span class="n">pyequib</span><span class="o">.</span><span class="n">redlaw_gal2</span><span class="p">(</span><span class="n">wavelength</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fl(6563)&#39;</span><span class="p">,</span> <span class="n">fl</span><span class="p">)</span>
<span class="go">   fl(6563)     -0.30925984</span>
</pre></div>
</div>
</dd>
<dt class="field-even">Categories</dt>
<dd class="field-even"><p>Interstellar Extinction</p>
</dd>
<dt class="field-odd">Dirs</dt>
<dd class="field-odd"><dl class="simple">
<dt>./</dt><dd><p>Subroutines</p>
</dd>
</dl>
</dd>
<dt class="field-even">Author</dt>
<dd class="field-even"><p>Ashkbiz Danehkar</p>
</dd>
<dt class="field-odd">Copyright</dt>
<dd class="field-odd"><p>This library is released under a GNU General Public License.</p>
</dd>
<dt class="field-even">Version</dt>
<dd class="field-even"><p>0.3.0</p>
</dd>
<dt class="field-odd">History</dt>
<dd class="field-odd"><p>Based on Savage &amp; Mathis 1979, ARA&amp;A, vol. 17, 73-111</p>
<p>Originally from IRAF STSDAS SYNPHOT ebmvxfunc.x</p>
<p>20/09/1994, R. A. Shaw, Initial IRAF implementation.</p>
<p>04/03/1995, R. A. Shaw, Return A(lambda)/A(V) instead.</p>
<p>31/08/2012, A. Danehkar, Converted to IDL code.</p>
<p>03/10/2020, A. Danehkar, Transferred from IDL to Python.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyequib.redlaw_jbk">
<code class="sig-prename descclassname">pyequib.</code><code class="sig-name descname">redlaw_jbk</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wavelength</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyequib.html#redlaw_jbk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyequib.redlaw_jbk" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This function determines the reddening law function for Galactic Whitford1958 + Seaton1977 + Kaler1976.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>type=double/array. This function returns the reddening law function value(s) for the given wavelength(s).</p>
</dd>
<dt class="field-even">Params</dt>
<dd class="field-even"><dl class="simple">
<dt>wavelength<span class="classifier">in, required, type=float</span></dt><dd><p>Wavelength in Angstrom</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Examples</dt>
<dd class="field-odd"><p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyequib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelength</span><span class="o">=</span><span class="mf">6563.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl</span><span class="o">=</span><span class="n">pyequib</span><span class="o">.</span><span class="n">redlaw_jbk</span><span class="p">(</span><span class="n">wavelength</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fl(6563)&#39;</span><span class="p">,</span> <span class="n">fl</span><span class="p">)</span>
<span class="go">   fl(6563)     -0.33113684</span>
</pre></div>
</div>
</dd>
<dt class="field-even">Categories</dt>
<dd class="field-even"><p>Interstellar Extinction</p>
</dd>
<dt class="field-odd">Dirs</dt>
<dd class="field-odd"><dl class="simple">
<dt>./</dt><dd><p>Subroutines</p>
</dd>
</dl>
</dd>
<dt class="field-even">Author</dt>
<dd class="field-even"><p>Ashkbiz Danehkar</p>
</dd>
<dt class="field-odd">Copyright</dt>
<dd class="field-odd"><p>This library is released under a GNU General Public License.</p>
</dd>
<dt class="field-even">Version</dt>
<dd class="field-even"><p>0.3.0</p>
</dd>
<dt class="field-odd">History</dt>
<dd class="field-odd"><p>Based on Whitford (1958), extended to the UV by Seaton (1977),
adapted by Kaler (1976).</p>
<p>Originally from IRAF STSDAS SYNPHOT redlaw.x</p>
<p>13/05/1993, R. A. Shaw, Initial IRAF implementation.</p>
<p>31/08/2012, A. Danehkar, Converted to IDL code.</p>
<p>03/10/2020, A. Danehkar, Transferred from IDL to Python.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyequib.redlaw_lmc">
<code class="sig-prename descclassname">pyequib.</code><code class="sig-name descname">redlaw_lmc</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wavelength</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyequib.html#redlaw_lmc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyequib.redlaw_lmc" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This function determines the reddening law function of the line at the given wavelength
for the Large Magellanic Cloud.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>type=double/array. This function returns the reddening law function value(s) for the given wavelength(s).</p>
</dd>
<dt class="field-even">Params</dt>
<dd class="field-even"><dl class="simple">
<dt>wavelength<span class="classifier">in, required, type=float</span></dt><dd><p>Wavelength in Angstrom</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Examples</dt>
<dd class="field-odd"><p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyequib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelength</span><span class="o">=</span><span class="mf">6563.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl</span><span class="o">=</span><span class="n">pyequib</span><span class="o">.</span><span class="n">redlaw_lmc</span><span class="p">(</span><span class="n">wavelength</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fl(6563)&#39;</span><span class="p">,</span> <span class="n">fl</span><span class="p">)</span>
<span class="go">   fl(6563)     -0.30871187</span>
</pre></div>
</div>
</dd>
<dt class="field-even">Categories</dt>
<dd class="field-even"><p>Interstellar Extinction</p>
</dd>
<dt class="field-odd">Dirs</dt>
<dd class="field-odd"><dl class="simple">
<dt>./</dt><dd><p>Subroutines</p>
</dd>
</dl>
</dd>
<dt class="field-even">Author</dt>
<dd class="field-even"><p>Ashkbiz Danehkar</p>
</dd>
<dt class="field-odd">Copyright</dt>
<dd class="field-odd"><p>This library is released under a GNU General Public License.</p>
</dd>
<dt class="field-even">Version</dt>
<dd class="field-even"><p>0.3.0</p>
</dd>
<dt class="field-odd">History</dt>
<dd class="field-odd"><p>Based on Formulae by Howarth 1983, MNRAS, 203, 301
1983MNRAS.203..301H</p>
<p>Originally from IRAF STSDAS SYNPHOT ebmvlfunc.x, redlaw.x</p>
<p>18/10/1994, R. A. Shaw, Initial IRAF implementation.</p>
<p>14/03/1995, R. A. Shaw, Return A(lambda)/A(V) instead.</p>
<p>31/08/2012, A. Danehkar, Converted to IDL code.</p>
<p>03/10/2020, A. Danehkar, Transferred from IDL to Python.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyequib.redlaw_smc">
<code class="sig-prename descclassname">pyequib.</code><code class="sig-name descname">redlaw_smc</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wavelength</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyequib.html#redlaw_smc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyequib.redlaw_smc" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This function determines the reddening law function of the line at the given wavelength
for Small Magellanic Cloud.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>type=double/array. This function returns the reddening law function value(s) for the given wavelength(s).</p>
</dd>
<dt class="field-even">Params</dt>
<dd class="field-even"><dl class="simple">
<dt>wavelength<span class="classifier">in, required, type=float</span></dt><dd><p>Wavelength in Angstrom</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Examples</dt>
<dd class="field-odd"><p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyequib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelength</span><span class="o">=</span><span class="mf">6563.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl</span><span class="o">=</span><span class="n">pyequib</span><span class="o">.</span><span class="n">redlaw_smc</span><span class="p">(</span><span class="n">wavelength</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fl(6563)&#39;</span><span class="p">,</span> <span class="n">fl</span><span class="p">)</span>
<span class="go">   fl(6563)     -0.22659261</span>
</pre></div>
</div>
</dd>
<dt class="field-even">Categories</dt>
<dd class="field-even"><p>Interstellar Extinction</p>
</dd>
<dt class="field-odd">Dirs</dt>
<dd class="field-odd"><dl class="simple">
<dt>./</dt><dd><p>Subroutines</p>
</dd>
</dl>
</dd>
<dt class="field-even">Author</dt>
<dd class="field-even"><p>Ashkbiz Danehkar</p>
</dd>
<dt class="field-odd">Copyright</dt>
<dd class="field-odd"><p>This library is released under a GNU General Public License.</p>
</dd>
<dt class="field-even">Version</dt>
<dd class="field-even"><p>0.3.0</p>
</dd>
<dt class="field-odd">History</dt>
<dd class="field-odd"><p>Based on Prevot et al. (1984), A&amp;A, 132, 389-392
1984A%26A…132..389P</p>
<p>Originally from IRAF STSDAS SYNPHOT redlaw.x, ebmvxfunc.x</p>
<p>20/09/1994, R. A. Shaw, Initial IRAF implementation.</p>
<p>04/03/1995, R. A. Shaw, Return A(lambda)/A(V) instead.</p>
<p>31/08/2012, A. Danehkar, Converted to IDL code.</p>
<p>03/10/2020, A. Danehkar, Transferred from IDL to Python.</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="../user/reference.html" class="btn btn-neutral float-left" title="References" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Ashkbiz Danehkar

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>